{"nbformat":4,"nbformat_minor":0,"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.7"},"colab":{"name":"Attacking distilBERT Trained on OPP-115","provenance":[{"file_id":"https://github.com/QData/TextAttack/blob/master/docs/2notebook/0_End_to_End.ipynb","timestamp":1620942907146}],"collapsed_sections":[],"toc_visible":true},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"016f3e5d182345e6a6eeabb7072f8379":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_9716245393b84aa1a6cad77955a730d0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_7e294eec672849b2be9bd0198687791b","IPY_MODEL_a1a3a0e79ff743f1aea48b90dc558d48"]}},"9716245393b84aa1a6cad77955a730d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7e294eec672849b2be9bd0198687791b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4c5f05afd0e041d9bfbd5311fa33a65d","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":213450,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":213450,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ea8d446196e04cee9782ba1c56a5a6a3"}},"a1a3a0e79ff743f1aea48b90dc558d48":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_20a2bc288e0c4729bf209cfbd9e35894","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 213k/213k [00:00&lt;00:00, 389kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5747f4401e3e410086ca5e29380256eb"}},"4c5f05afd0e041d9bfbd5311fa33a65d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ea8d446196e04cee9782ba1c56a5a6a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"20a2bc288e0c4729bf209cfbd9e35894":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5747f4401e3e410086ca5e29380256eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4254ee1891254c04a18c64c94e7cdfa6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d2973c7e4423421181b868e662c88ae4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c129e22e189c49c58c99e7fcb3fd278e","IPY_MODEL_ab3bb2aa6a9b45efbc41d73ba935b4ff"]}},"d2973c7e4423421181b868e662c88ae4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c129e22e189c49c58c99e7fcb3fd278e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_07aff1c4a166414884f1038d4e03e5e6","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":435797,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":435797,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_31175c9add154b4e8ae0f75ba541cd65"}},"ab3bb2aa6a9b45efbc41d73ba935b4ff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_90f609691c874cdb9649899512680d28","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 436k/436k [00:01&lt;00:00, 244kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_726994f398a5457499c66d54d3f779ad"}},"07aff1c4a166414884f1038d4e03e5e6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"31175c9add154b4e8ae0f75ba541cd65":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"90f609691c874cdb9649899512680d28":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"726994f398a5457499c66d54d3f779ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4d53e83510784b06891525948a48ae97":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_092db47d70fe40168601f016c86c9767","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_af125ebcf6424e2a95b4bd6f915d8e56","IPY_MODEL_5044da390a9f419888d6d218a49a07fe"]}},"092db47d70fe40168601f016c86c9767":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"af125ebcf6424e2a95b4bd6f915d8e56":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7a3a7ff5d26f4e7589eb337875736be6","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":29,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":29,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ac720ecc3d934e27aee2246f95adabca"}},"5044da390a9f419888d6d218a49a07fe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a7b027bb6cfd4351afa0d55b49ed351b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29.0/29.0 [00:00&lt;00:00, 46.2B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_660775eaeb1b4028aef3aa79346daf57"}},"7a3a7ff5d26f4e7589eb337875736be6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ac720ecc3d934e27aee2246f95adabca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a7b027bb6cfd4351afa0d55b49ed351b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"660775eaeb1b4028aef3aa79346daf57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"4ba5SKTDuItO"},"source":["# TextAttack End-to-End\n","\n","In this experiment we will conduct training, evaluating, and attacking a model using TextAttack. In particular, we will use a pretrained distilBert model on the OPP-115 dataset for the task of segmenet classification. "]},{"cell_type":"markdown","metadata":{"id":"pAULWT84i0fE"},"source":["# Imports & Dependencies"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eIfEBtQj0og4","executionInfo":{"status":"ok","timestamp":1621014269254,"user_tz":240,"elapsed":202924,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"9dd40274-d03a-49ff-99a7-0198dbade4bc"},"source":["%%shell\n","rm -rf ./sample_data/\n","pip install transformers\n","pip install textattack\n","pip install torch==1.6 # need torch 1.6 for the augmenter to work"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Collecting transformers\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/b0/9e/5b80becd952d5f7250eaf8fc64b957077b12ccfe73e9c03d37146ab29712/transformers-4.6.0-py3-none-any.whl (2.3MB)\n","\u001b[K     |████████████████████████████████| 2.3MB 10.0MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/75/ee/67241dc87f266093c533a2d4d3d69438e57d7a90abb216fa076e7d475d4a/sacremoses-0.0.45-py3-none-any.whl (895kB)\n","\u001b[K     |████████████████████████████████| 901kB 52.8MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.41.1)\n","Requirement already satisfied: importlib-metadata; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from transformers) (4.0.1)\n","Collecting tokenizers<0.11,>=0.10.1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ae/04/5b870f26a858552025a62f1649c20d29d2672c02ff3c3fb4c688ca46467a/tokenizers-0.10.2-cp37-cp37m-manylinux2010_x86_64.whl (3.3MB)\n","\u001b[K     |████████████████████████████████| 3.3MB 47.1MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.0.12)\n","Collecting huggingface-hub==0.0.8\n","  Downloading https://files.pythonhosted.org/packages/a1/88/7b1e45720ecf59c6c6737ff332f41c955963090a18e72acbcbeac6b25e86/huggingface_hub-0.0.8-py3-none-any.whl\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.19.5)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers) (20.9)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (8.0.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.0.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: typing-extensions>=3.6.4; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->transformers) (3.7.4.3)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->transformers) (3.4.1)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2020.12.5)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers) (2.4.7)\n","Installing collected packages: sacremoses, tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.0.8 sacremoses-0.0.45 tokenizers-0.10.2 transformers-4.6.0\n","Collecting textattack\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/0f/82/2f16ef7f22f19b3a49bbcd079dc31e53d362e1ef1299298c3eda05cf2b3a/textattack-0.2.15-py3-none-any.whl (349kB)\n","\u001b[K     |████████████████████████████████| 358kB 9.2MB/s \n","\u001b[?25hCollecting word2number\n","  Downloading https://files.pythonhosted.org/packages/4a/29/a31940c848521f0725f0df6b25dca8917f13a2025b0e8fcbe5d0457e45e6/word2number-1.1.zip\n","Collecting lru-dict\n","  Downloading https://files.pythonhosted.org/packages/68/ea/997af58d4e6da019ad825a412f93081d9df67e9dda11cfb026a3d7cd0b6c/lru-dict-1.1.7.tar.gz\n","Collecting flair==0.6.1.post1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/4a/49/a812ed93088ba9519cbb40eb9f52341694b31cfa126bfddcd9db3761f3ac/flair-0.6.1.post1-py3-none-any.whl (337kB)\n","\u001b[K     |████████████████████████████████| 337kB 35.5MB/s \n","\u001b[?25hCollecting num2words\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/eb/a2/ea800689730732e27711c41beed4b2a129b34974435bdc450377ec407738/num2words-0.5.10-py3-none-any.whl (101kB)\n","\u001b[K     |████████████████████████████████| 102kB 12.9MB/s \n","\u001b[?25hRequirement already satisfied: editdistance in /usr/local/lib/python3.7/dist-packages (from textattack) (0.5.3)\n","Requirement already satisfied: transformers>=3.3.0 in /usr/local/lib/python3.7/dist-packages (from textattack) (4.6.0)\n","Collecting datasets\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/46/1a/b9f9b3bfef624686ae81c070f0a6bb635047b17cdb3698c7ad01281e6f9a/datasets-1.6.2-py3-none-any.whl (221kB)\n","\u001b[K     |████████████████████████████████| 225kB 35.8MB/s \n","\u001b[?25hRequirement already satisfied: tqdm<4.50.0,>=4.27 in /usr/local/lib/python3.7/dist-packages (from textattack) (4.41.1)\n","Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /usr/local/lib/python3.7/dist-packages (from textattack) (1.7.1)\n","Collecting terminaltables\n","  Downloading https://files.pythonhosted.org/packages/9b/c4/4a21174f32f8a7e1104798c445dacdc1d4df86f2f26722767034e4de4bff/terminaltables-3.1.0.tar.gz\n","Collecting numpy<1.19.0\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d6/c6/58e517e8b1fb192725cfa23c01c2e60e4e6699314ee9684a1c5f5c9b27e1/numpy-1.18.5-cp37-cp37m-manylinux1_x86_64.whl (20.1MB)\n","\u001b[K     |████████████████████████████████| 20.1MB 74.3MB/s \n","\u001b[?25hCollecting bert-score>=0.3.5\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/38/fb/e63e7e231a79db0489dbf7e7d0ebfb279ccb3d8216aa0d133572f784f3fa/bert_score-0.3.9-py3-none-any.whl (59kB)\n","\u001b[K     |████████████████████████████████| 61kB 8.5MB/s \n","\u001b[?25hRequirement already satisfied: pandas>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from textattack) (1.1.5)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from textattack) (3.0.12)\n","Collecting language-tool-python\n","  Downloading https://files.pythonhosted.org/packages/37/26/48b22ad565fd372edec3577218fb817e0e6626bf4e658033197470ad92b3/language_tool_python-2.5.3-py3-none-any.whl\n","Collecting lemminflect\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/4b/67/d04ca98b661d4ad52b9b965c9dabb1f1a2c85541d20f8decb9a9df4e4b32/lemminflect-0.2.2-py3-none-any.whl (769kB)\n","\u001b[K     |████████████████████████████████| 778kB 43.4MB/s \n","\u001b[?25hRequirement already satisfied: more-itertools in /usr/local/lib/python3.7/dist-packages (from textattack) (8.7.0)\n","Requirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (from textattack) (3.2.5)\n","Requirement already satisfied: torch in /usr/local/lib/python3.7/dist-packages (from textattack) (1.8.1+cu101)\n","Requirement already satisfied: scipy==1.4.1 in /usr/local/lib/python3.7/dist-packages (from textattack) (1.4.1)\n","Collecting bpemb>=0.3.2\n","  Downloading https://files.pythonhosted.org/packages/f2/6f/9191b85109772636a8f8accb122900c34db26c091d2793218aa94954524c/bpemb-0.3.3-py3-none-any.whl\n","Collecting deprecated>=1.2.4\n","  Downloading https://files.pythonhosted.org/packages/fb/73/994edfcba74443146c84b91921fcc269374354118d4f452fb0c54c1cbb12/Deprecated-1.2.12-py2.py3-none-any.whl\n","Requirement already satisfied: scikit-learn>=0.21.3 in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (0.22.2.post1)\n","Collecting ftfy\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ce/b5/5da463f9c7823e0e575e9908d004e2af4b36efa8d02d3d6dad57094fcb11/ftfy-6.0.1.tar.gz (63kB)\n","\u001b[K     |████████████████████████████████| 71kB 10.9MB/s \n","\u001b[?25hRequirement already satisfied: python-dateutil>=2.6.1 in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (2.8.1)\n","Collecting langdetect\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/0e/72/a3add0e4eec4eb9e2569554f7c70f4a3c27712f40e3284d483e88094cc0e/langdetect-1.0.9.tar.gz (981kB)\n","\u001b[K     |████████████████████████████████| 983kB 37.0MB/s \n","\u001b[?25hCollecting mpld3==0.3\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/91/95/a52d3a83d0a29ba0d6898f6727e9858fe7a43f6c2ce81a5fe7e05f0f4912/mpld3-0.3.tar.gz (788kB)\n","\u001b[K     |████████████████████████████████| 798kB 37.1MB/s \n","\u001b[?25hCollecting sentencepiece!=0.1.92\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/f5/99/e0808cb947ba10f575839c43e8fafc9cc44e4a7a2c8f79c60db48220a577/sentencepiece-0.1.95-cp37-cp37m-manylinux2014_x86_64.whl (1.2MB)\n","\u001b[K     |████████████████████████████████| 1.2MB 43.6MB/s \n","\u001b[?25hRequirement already satisfied: gdown in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (3.6.4)\n","Requirement already satisfied: tabulate in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (0.8.9)\n","Requirement already satisfied: matplotlib>=2.2.3 in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (3.2.2)\n","Requirement already satisfied: regex in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (2019.12.20)\n","Collecting sqlitedict>=1.6.0\n","  Downloading https://files.pythonhosted.org/packages/5c/2d/b1d99e9ad157dd7de9cd0d36a8a5876b13b55e4b75f7498bc96035fb4e96/sqlitedict-1.7.0.tar.gz\n","Collecting janome\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/a8/63/98858cbead27df7536c7e300c169da0999e9704d02220dc6700b804eeff0/Janome-0.4.1-py2.py3-none-any.whl (19.7MB)\n","\u001b[K     |████████████████████████████████| 19.7MB 1.2MB/s \n","\u001b[?25hCollecting segtok>=1.5.7\n","  Downloading https://files.pythonhosted.org/packages/41/08/582dab5f4b1d5ca23bc6927b4bb977c8ff7f3a87a3b98844ef833e2f5623/segtok-1.5.10.tar.gz\n","Collecting konoha<5.0.0,>=4.0.0\n","  Downloading https://files.pythonhosted.org/packages/02/be/4dd30d56a0a19619deb9bf41ba8202709fa83b1b301b876572cd6dc38117/konoha-4.6.4-py3-none-any.whl\n","Requirement already satisfied: hyperopt>=0.1.1 in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (0.1.2)\n","Requirement already satisfied: gensim>=3.4.0 in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (3.6.0)\n","Requirement already satisfied: lxml in /usr/local/lib/python3.7/dist-packages (from flair==0.6.1.post1->textattack) (4.2.6)\n","Requirement already satisfied: docopt>=0.6.2 in /usr/local/lib/python3.7/dist-packages (from num2words->textattack) (0.6.2)\n","Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (0.10.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (2.23.0)\n","Requirement already satisfied: importlib-metadata; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (4.0.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (20.9)\n","Requirement already satisfied: huggingface-hub==0.0.8 in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (0.0.8)\n","Requirement already satisfied: sacremoses in /usr/local/lib/python3.7/dist-packages (from transformers>=3.3.0->textattack) (0.0.45)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets->textattack) (0.70.11.1)\n","Requirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets->textattack) (0.3.3)\n","Collecting xxhash\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/4f/0a862cad26aa2ed7a7cd87178cbbfa824fc1383e472d63596a0d018374e7/xxhash-2.0.2-cp37-cp37m-manylinux2010_x86_64.whl (243kB)\n","\u001b[K     |████████████████████████████████| 245kB 41.9MB/s \n","\u001b[?25hCollecting fsspec\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/bc/52/816d1a3a599176057bf29dfacb1f8fadb61d35fbd96cb1bab4aaa7df83c0/fsspec-2021.5.0-py3-none-any.whl (111kB)\n","\u001b[K     |████████████████████████████████| 112kB 53.9MB/s \n","\u001b[?25hRequirement already satisfied: pyarrow>=1.0.0<4.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets->textattack) (3.0.0)\n","Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas>=1.0.1->textattack) (2018.9)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from nltk->textattack) (1.15.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch->textattack) (3.7.4.3)\n","Requirement already satisfied: wrapt<2,>=1.10 in /usr/local/lib/python3.7/dist-packages (from deprecated>=1.2.4->flair==0.6.1.post1->textattack) (1.12.1)\n","Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn>=0.21.3->flair==0.6.1.post1->textattack) (1.0.1)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from ftfy->flair==0.6.1.post1->textattack) (0.2.5)\n","Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=2.2.3->flair==0.6.1.post1->textattack) (2.4.7)\n","Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=2.2.3->flair==0.6.1.post1->textattack) (1.3.1)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=2.2.3->flair==0.6.1.post1->textattack) (0.10.0)\n","Collecting overrides<4.0.0,>=3.0.0\n","  Downloading https://files.pythonhosted.org/packages/ff/b1/10f69c00947518e6676bbd43e739733048de64b8dd998e9c2d5a71f44c5d/overrides-3.1.0.tar.gz\n","Requirement already satisfied: pymongo in /usr/local/lib/python3.7/dist-packages (from hyperopt>=0.1.1->flair==0.6.1.post1->textattack) (3.11.4)\n","Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from hyperopt>=0.1.1->flair==0.6.1.post1->textattack) (0.16.0)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.7/dist-packages (from hyperopt>=0.1.1->flair==0.6.1.post1->textattack) (2.5.1)\n","Requirement already satisfied: smart-open>=1.2.1 in /usr/local/lib/python3.7/dist-packages (from gensim>=3.4.0->flair==0.6.1.post1->textattack) (5.0.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers>=3.3.0->textattack) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers>=3.3.0->textattack) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers>=3.3.0->textattack) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers>=3.3.0->textattack) (2020.12.5)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->transformers>=3.3.0->textattack) (3.4.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers>=3.3.0->textattack) (8.0.0)\n","Requirement already satisfied: decorator<5,>=4.3 in /usr/local/lib/python3.7/dist-packages (from networkx->hyperopt>=0.1.1->flair==0.6.1.post1->textattack) (4.4.2)\n","Building wheels for collected packages: word2number, lru-dict, terminaltables, ftfy, langdetect, mpld3, sqlitedict, segtok, overrides\n","  Building wheel for word2number (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for word2number: filename=word2number-1.1-cp37-none-any.whl size=5589 sha256=501163479901b8ace08ac12194cd44e6822ed1dca6a3acb09281ffa108b19c3f\n","  Stored in directory: /root/.cache/pip/wheels/46/2f/53/5f5c1d275492f2fce1cdab9a9bb12d49286dead829a4078e0e\n","  Building wheel for lru-dict (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for lru-dict: filename=lru_dict-1.1.7-cp37-cp37m-linux_x86_64.whl size=28375 sha256=035d8e30da0e0d275b38d60d349fa30b5d9271e22481c3e1ee4bcafc2a2ab252\n","  Stored in directory: /root/.cache/pip/wheels/ae/51/23/0a416781dead9225c7d66d25b9f223c7e32304e99a0b01d566\n","  Building wheel for terminaltables (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for terminaltables: filename=terminaltables-3.1.0-cp37-none-any.whl size=15356 sha256=88acb3bc5f2c4c5e53c87912c59e93cd3ec1ddf331ea97785a8135bfa234251a\n","  Stored in directory: /root/.cache/pip/wheels/30/6b/50/6c75775b681fb36cdfac7f19799888ef9d8813aff9e379663e\n","  Building wheel for ftfy (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for ftfy: filename=ftfy-6.0.1-cp37-none-any.whl size=41573 sha256=a44f7eaba1a60956edb301adfc51245a71e218a288b8bfd8ac0000cb63c71e8b\n","  Stored in directory: /root/.cache/pip/wheels/ae/73/c7/9056e14b04919e5c262fe80b54133b1a88d73683d05d7ac65c\n","  Building wheel for langdetect (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for langdetect: filename=langdetect-1.0.9-cp37-none-any.whl size=993223 sha256=b8b93e20487058a03ef033ffc8cfa61b75976321ba44c4f066c62ab696910ba8\n","  Stored in directory: /root/.cache/pip/wheels/7e/18/13/038c34057808931c7ddc6c92d3aa015cf1a498df5a70268996\n","  Building wheel for mpld3 (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for mpld3: filename=mpld3-0.3-cp37-none-any.whl size=116679 sha256=32e9c0ecaa7d639cedb4194cb4266bcf3e3cca651705ef3ef5d12a52e60e6ddf\n","  Stored in directory: /root/.cache/pip/wheels/c0/47/fb/8a64f89aecfe0059830479308ad42d62e898a3e3cefdf6ba28\n","  Building wheel for sqlitedict (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sqlitedict: filename=sqlitedict-1.7.0-cp37-none-any.whl size=14376 sha256=b81b136faadc8ffd8f73f3448efa1e4395eadf1b9a27938ef9d4dbc8b3cf9dae\n","  Stored in directory: /root/.cache/pip/wheels/cf/c6/4f/2c64a43f041415eb8b8740bd80e15e92f0d46c5e464d8e4b9b\n","  Building wheel for segtok (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for segtok: filename=segtok-1.5.10-cp37-none-any.whl size=25019 sha256=43678bee3ccad74b09b380f6f5271f97f2c041a4298bd4da991c2589c19afc33\n","  Stored in directory: /root/.cache/pip/wheels/b4/39/f6/9ca1c5cabde964d728023b5751c3a206a5c8cc40252321fb6b\n","  Building wheel for overrides (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for overrides: filename=overrides-3.1.0-cp37-none-any.whl size=10174 sha256=252c953dd5c50f73d421bfca94c7b912aed92a150f0b0875c2c03d0fde2f88a8\n","  Stored in directory: /root/.cache/pip/wheels/5c/24/13/6ef8600e6f147c95e595f1289a86a3cc82ed65df57582c65a9\n","Successfully built word2number lru-dict terminaltables ftfy langdetect mpld3 sqlitedict segtok overrides\n","\u001b[31mERROR: tensorflow 2.4.1 has requirement numpy~=1.19.2, but you'll have numpy 1.18.5 which is incompatible.\u001b[0m\n","\u001b[31mERROR: datascience 0.10.6 has requirement folium==0.2.1, but you'll have folium 0.8.3 which is incompatible.\u001b[0m\n","\u001b[31mERROR: albumentations 0.1.12 has requirement imgaug<0.2.7,>=0.2.5, but you'll have imgaug 0.2.9 which is incompatible.\u001b[0m\n","\u001b[31mERROR: konoha 4.6.4 has requirement importlib-metadata<4.0.0,>=3.7.0, but you'll have importlib-metadata 4.0.1 which is incompatible.\u001b[0m\n","\u001b[31mERROR: konoha 4.6.4 has requirement requests<3.0.0,>=2.25.1, but you'll have requests 2.23.0 which is incompatible.\u001b[0m\n","Installing collected packages: word2number, lru-dict, sentencepiece, numpy, bpemb, deprecated, ftfy, langdetect, mpld3, sqlitedict, janome, segtok, overrides, konoha, flair, num2words, xxhash, fsspec, datasets, terminaltables, bert-score, language-tool-python, lemminflect, textattack\n","  Found existing installation: numpy 1.19.5\n","    Uninstalling numpy-1.19.5:\n","      Successfully uninstalled numpy-1.19.5\n","Successfully installed bert-score-0.3.9 bpemb-0.3.3 datasets-1.6.2 deprecated-1.2.12 flair-0.6.1.post1 fsspec-2021.5.0 ftfy-6.0.1 janome-0.4.1 konoha-4.6.4 langdetect-1.0.9 language-tool-python-2.5.3 lemminflect-0.2.2 lru-dict-1.1.7 mpld3-0.3 num2words-0.5.10 numpy-1.18.5 overrides-3.1.0 segtok-1.5.10 sentencepiece-0.1.95 sqlitedict-1.7.0 terminaltables-3.1.0 textattack-0.2.15 word2number-1.1 xxhash-2.0.2\n","Collecting torch==1.6\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/5d/5e/35140615fc1f925023f489e71086a9ecc188053d263d3594237281284d82/torch-1.6.0-cp37-cp37m-manylinux1_x86_64.whl (748.8MB)\n","\u001b[K     |████████████████████████████████| 748.8MB 19kB/s \n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from torch==1.6) (1.18.5)\n","Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from torch==1.6) (0.16.0)\n","\u001b[31mERROR: torchvision 0.9.1+cu101 has requirement torch==1.8.1, but you'll have torch 1.6.0 which is incompatible.\u001b[0m\n","\u001b[31mERROR: torchtext 0.9.1 has requirement torch==1.8.1, but you'll have torch 1.6.0 which is incompatible.\u001b[0m\n","Installing collected packages: torch\n","  Found existing installation: torch 1.8.1+cu101\n","    Uninstalling torch-1.8.1+cu101:\n","      Successfully uninstalled torch-1.8.1+cu101\n","Successfully installed torch-1.6.0\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":[""]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"code","metadata":{"id":"1edW-Qq6i8LX"},"source":["import torch\n","device = 'cuda' if torch.cuda.is_available() else 'cpu'\n","import pandas as pd\n","import numpy as np\n","from google.colab import drive\n","import transformers\n","from transformers import DistilBertTokenizerFast, DistilBertModel, BertConfig, DistilBertPreTrainedModel\n","from transformers import DistilBertForSequenceClassification, Trainer, TrainingArguments\n","from sklearn import metrics\n","from sklearn.model_selection import train_test_split\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import seaborn as sns\n","from sklearn.metrics import multilabel_confusion_matrix\n","from sklearn.metrics import plot_confusion_matrix\n","from sklearn.metrics import classification_report, f1_score, accuracy_score\n","import pickle\n","import textattack"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Nvq0e94XjLdY"},"source":["## Load & Prepare the OPP-115 Dataset from the Benchmark Paper (\"Majority\" Version)"]},{"cell_type":"markdown","metadata":{"id":"AZmtoo_tjpHU"},"source":["Mount Drive"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9u-BVO73jnrh","executionInfo":{"status":"ok","timestamp":1621014438465,"user_tz":240,"elapsed":24052,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"e0bc293e-49b3-444d-efa8-18fedb788b04"},"source":["from google.colab import drive\n","drive.mount('/content/drive/')"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Mounted at /content/drive/\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PmMLFdcio01C","executionInfo":{"status":"ok","timestamp":1621014775042,"user_tz":240,"elapsed":3480,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"809b297e-8cdc-4166-a00e-d0757eaa9097"},"source":["train_set = pd.read_csv('/content/drive/MyDrive/828E_Ophir_Mollie/Polisis_Benchmark/datasets/Majority/train_dataset.csv', names=['segment', 'label'])\n","valid_set = pd.read_csv('/content/drive/MyDrive/828E_Ophir_Mollie/Polisis_Benchmark/datasets/Majority/validation_dataset.csv', names=['segment', 'label'])\n","test_set = pd.read_csv('/content/drive/MyDrive/828E_Ophir_Mollie/Polisis_Benchmark/datasets/Majority/test_dataset.csv', names=['segment', 'label'])\n","print('train set labels')\n","print('\\n'.join([str(i)+'. '+ s for i, s in enumerate(train_set.label.unique())]))\n","print()\n","print('valid set labels')\n","print('\\n'.join([str(i)+'. '+ s for i, s in enumerate(valid_set.label.unique())]))\n","print()\n","print('test set labels')\n","print('\\n'.join([str(i)+'. '+ s for i, s in enumerate(test_set.label.unique())]))\n","print()"],"execution_count":null,"outputs":[{"output_type":"stream","text":["train set labels\n","0. First Party Collection/Use\n","1. Third Party Sharing/Collection\n","2. User Choice/Control\n","3. Privacy contact information\n","4. Introductory/Generic\n","5. Practice not covered\n","6. Data Security\n","7. User Access, Edit and Deletion\n","8. Policy Change\n","9. Do Not Track\n","10. International and Specific Audiences\n","11. Data Retention\n","\n","valid set labels\n","0. International and Specific Audiences\n","1. Privacy contact information\n","2. First Party Collection/Use\n","3. Third Party Sharing/Collection\n","4. Introductory/Generic\n","5. Practice not covered\n","6. Data Security\n","7. User Access, Edit and Deletion\n","8. Do Not Track\n","9. Data Retention\n","10. Policy Change\n","11. User Choice/Control\n","\n","test set labels\n","0. Introductory/Generic\n","1. Data Retention\n","2. User Access, Edit and Deletion\n","3. Privacy contact information\n","4. First Party Collection/Use\n","5. Third Party Sharing/Collection\n","6. Data Security\n","7. User Choice/Control\n","8. Policy Change\n","9. International and Specific Audiences\n","10. Practice not covered\n","11. Do Not Track\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"A3Ds9BBV0rCZ"},"source":["Convert text labels to numbers"]},{"cell_type":"code","metadata":{"id":"6vdoo5IIqg53"},"source":["label2idx = dict([('First Party Collection/Use', 0),\n","             ('Third Party Sharing/Collection', 1),\n","             ('User Access, Edit and Deletion', 2),\n","             ('Data Retention', 3),\n","             ('Data Security', 4),\n","             ('International and Specific Audiences', 5),\n","             ('Do Not Track', 6),\n","             ('Policy Change', 7),\n","             ('User Choice/Control', 8),\n","             ('Introductory/Generic', 9),\n","             ('Practice not covered', 10),\n","             ('Privacy contact information', 11)])\n","idx2label = {value : key for (key, value) in label2idx.items()}"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tbXpWqCBzgDT","executionInfo":{"status":"ok","timestamp":1621014775874,"user_tz":240,"elapsed":466,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"8cf48e90-0b13-49a9-c993-4fac0673ffaa"},"source":["train_set.label = train_set.label.apply(lambda s: label2idx[s])\n","valid_set.label = valid_set.label.apply(lambda s: label2idx[s])\n","test_set.label = test_set.label.apply(lambda s: label2idx[s])\n","print('train set labels')\n","print('\\n'.join([str(i)+'. '+ str(s) for i, s in enumerate(train_set.label.unique())]))\n","print()\n","print('valid set labels')\n","print('\\n'.join([str(i)+'. '+ str(s) for i, s in enumerate(valid_set.label.unique())]))\n","print()\n","print('test set labels')\n","print('\\n'.join([str(i)+'. '+ str(s) for i, s in enumerate(test_set.label.unique())]))\n","print()"],"execution_count":null,"outputs":[{"output_type":"stream","text":["train set labels\n","0. 0\n","1. 1\n","2. 8\n","3. 11\n","4. 9\n","5. 10\n","6. 4\n","7. 2\n","8. 7\n","9. 6\n","10. 5\n","11. 3\n","\n","valid set labels\n","0. 5\n","1. 11\n","2. 0\n","3. 1\n","4. 9\n","5. 10\n","6. 4\n","7. 2\n","8. 6\n","9. 3\n","10. 7\n","11. 8\n","\n","test set labels\n","0. 9\n","1. 3\n","2. 2\n","3. 11\n","4. 0\n","5. 1\n","6. 4\n","7. 8\n","8. 7\n","9. 5\n","10. 10\n","11. 6\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":181,"referenced_widgets":["016f3e5d182345e6a6eeabb7072f8379","9716245393b84aa1a6cad77955a730d0","7e294eec672849b2be9bd0198687791b","a1a3a0e79ff743f1aea48b90dc558d48","4c5f05afd0e041d9bfbd5311fa33a65d","ea8d446196e04cee9782ba1c56a5a6a3","20a2bc288e0c4729bf209cfbd9e35894","5747f4401e3e410086ca5e29380256eb","4254ee1891254c04a18c64c94e7cdfa6","d2973c7e4423421181b868e662c88ae4","c129e22e189c49c58c99e7fcb3fd278e","ab3bb2aa6a9b45efbc41d73ba935b4ff","07aff1c4a166414884f1038d4e03e5e6","31175c9add154b4e8ae0f75ba541cd65","90f609691c874cdb9649899512680d28","726994f398a5457499c66d54d3f779ad","4d53e83510784b06891525948a48ae97","092db47d70fe40168601f016c86c9767","af125ebcf6424e2a95b4bd6f915d8e56","5044da390a9f419888d6d218a49a07fe","7a3a7ff5d26f4e7589eb337875736be6","ac720ecc3d934e27aee2246f95adabca","a7b027bb6cfd4351afa0d55b49ed351b","660775eaeb1b4028aef3aa79346daf57"]},"id":"JOTlI5enXPzr","executionInfo":{"status":"ok","timestamp":1621014810986,"user_tz":240,"elapsed":3951,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"3aa7507f-fc7f-4082-f5c7-3be2e6fc9983"},"source":["tokenizer = DistilBertTokenizerFast.from_pretrained('bert-base-cased')\n","train_encodings = tokenizer(train_set.segment.to_list(), truncation=True, padding=True)\n","val_encodings = tokenizer(valid_set.segment.to_list(), truncation=True, padding=True)\n","test_encodings = tokenizer(test_set.segment.to_list(), truncation=True, padding=True)\n","class OppDataset(torch.utils.data.Dataset):\n","    def __init__(self, encodings, labels):\n","        self.encodings = encodings\n","        self.labels = labels\n","\n","    def __getitem__(self, idx):\n","        item = {key: torch.tensor(val[idx]) for key, val in self.encodings.items()}\n","        item['labels'] = torch.tensor(self.labels[idx])\n","        return item\n","\n","    def __len__(self):\n","        return len(self.labels)\n","\n","train_dataset = OppDataset(train_encodings, train_set.label.to_list())\n","val_dataset = OppDataset(val_encodings, valid_set.label.to_list())\n","test_dataset = OppDataset(test_encodings, test_set.label.to_list())"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"016f3e5d182345e6a6eeabb7072f8379","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=213450.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4254ee1891254c04a18c64c94e7cdfa6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=435797.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4d53e83510784b06891525948a48ae97","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=29.0, style=ProgressStyle(description_w…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\n"],"name":"stderr"},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"PobbiLmmuItV"},"source":["## Training (original training data)\n"]},{"cell_type":"code","metadata":{"id":"SIoMmX-lhNEm"},"source":["output_dir = '/content/drive/MyDrive/828E_Ophir_Mollie/trained_models/non-robust_model_300_epochs_opp'"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"v_SzAim8uItW","colab":{"base_uri":"https://localhost:8080/","height":392},"executionInfo":{"status":"ok","timestamp":1620972633056,"user_tz":240,"elapsed":1169930,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghc7IMJmHGBHX09cRSdZE-ghxUmylfzPbFKdpxEUQ=s64","userId":"18416188950270533293"}},"outputId":"7ad8687a-60ce-4c4f-9104-162e6d1beee6"},"source":["training_args = TrainingArguments(\n","    output_dir=output_dir, # output directory for model predictions and checkpoints\n","    num_train_epochs=7,              # total number of training epochs\n","    per_device_train_batch_size=16,  # batch size per device during training\n","    per_device_eval_batch_size=64,   # batch size for evaluation\n","    warmup_steps=500,                # number of warmup steps for learning rate scheduler\n","    weight_decay=0.01,               # strength of weight decay\n","    logging_steps=10,\n","    logging_dir=output_dir+'/logs',\n","    load_best_model_at_end=True, # will save/checkpoint the model after every evaluation\n","    evaluation_strategy=\"epoch\", # will evaluate every epoch\n","    # DO NOT USE # label_names=label_names,  # DO NOT USE THIS --- THROWS ERROR\n",")\n","\n","NUM_LABELS = len(idx2label)\n","model = DistilBertForSequenceClassification.from_pretrained(\n","    \"distilbert-base-cased\", \n","    num_labels=NUM_LABELS,\n","    id2label=idx2label, # use to show text labels\n","    )\n","\n","trainer = Trainer(\n","    model=model,                         # the instantiated 🤗 Transformers model to be trained\n","    args=training_args,                  # training arguments, defined above\n","    train_dataset=train_dataset,         # training dataset\n","    eval_dataset=val_dataset,            # evaluation dataset\n",")\n","\n","# Start the training\n","trainer.train()\n","# Save model\n","model.save_pretrained(output_dir)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Some weights of the model checkpoint at distilbert-base-cased were not used when initializing DistilBertForSequenceClassification: ['vocab_transform.weight', 'vocab_projector.bias', 'vocab_projector.weight', 'vocab_layer_norm.bias', 'vocab_transform.bias', 'vocab_layer_norm.weight']\n","- This IS expected if you are initializing DistilBertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-cased and are newly initialized: ['pre_classifier.weight', 'classifier.weight', 'pre_classifier.bias', 'classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"],"name":"stderr"},{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='1155' max='1155' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1155/1155 19:24, Epoch 7/7]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>1.831100</td>\n","      <td>1.711555</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>1.167400</td>\n","      <td>1.073737</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>1.067600</td>\n","      <td>0.993681</td>\n","    </tr>\n","    <tr>\n","      <td>4</td>\n","      <td>0.670300</td>\n","      <td>0.896062</td>\n","    </tr>\n","    <tr>\n","      <td>5</td>\n","      <td>0.713000</td>\n","      <td>0.815847</td>\n","    </tr>\n","    <tr>\n","      <td>6</td>\n","      <td>0.508900</td>\n","      <td>0.796503</td>\n","    </tr>\n","    <tr>\n","      <td>7</td>\n","      <td>0.476700</td>\n","      <td>0.797068</td>\n","    </tr>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"Sn7VcJB9boVS","colab":{"base_uri":"https://localhost:8080/","height":291},"executionInfo":{"status":"ok","timestamp":1621031167800,"user_tz":240,"elapsed":949,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"72a31ee0-c599-450e-afce-bf2e672d4724"},"source":["log = \"\"\"Epoch\tTraining Loss\tValidation Loss\n","1\t1.831100\t1.711555\n","2\t1.167400\t1.073737\n","3\t1.067600\t0.993681\n","4\t0.670300\t0.896062\n","5\t0.713000\t0.815847\n","6\t0.508900\t0.796503\n","7\t0.476700\t0.797068\n","\"\"\"\n","with open(output_dir+'/train_history_log', 'w') as f:\n","    f.write(log)\n","\n","history = pd.read_csv(output_dir+'/train_history_log',sep='\\t')\n","\n","plt.style.use('seaborn-whitegrid')\n","plt.figure(figsize=(6,4))\n","plt.plot(history['Epoch'], history['Training Loss'], label='Training Loss')\n","plt.plot(history['Epoch'], history['Validation Loss'], label='Validation Loss')\n","plt.xlabel(\"No. Epoch\")\n","plt.ylabel(\"Loss\")\n","plt.title(\"Fine-tuned DistilBert\")\n","plt.legend()\n","plt.savefig(output_dir+'/train_history_plot.png', dpi=300)\n","plt.show()"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"FrmVWdXAeCDR"},"source":["training_args = TrainingArguments(\n","    output_dir=output_dir, # output directory for model predictions and checkpoints\n","    num_train_epochs=100,              # total number of training epochs\n","    per_device_train_batch_size=16,  # batch size per device during training\n","    per_device_eval_batch_size=64,   # batch size for evaluation\n","    warmup_steps=500,                # number of warmup steps for learning rate scheduler\n","    weight_decay=0.01,               # strength of weight decay\n","    logging_steps=10,\n","    logging_dir=output_dir+'/logs',\n","    load_best_model_at_end=True, # will save/checkpoint the model after every evaluation\n","    evaluation_strategy=\"epoch\", # will evaluate every epoch\n","    # DO NOT USE # label_names=label_names,  # DO NOT USE THIS --- THROWS ERROR\n",")\n","\n","model = DistilBertForSequenceClassification.from_pretrained(\n","    output_dir, \n","    num_labels=NUM_LABELS,\n","    id2label=idx2label, # use to show text labels\n","    )\n","\n","trainer = Trainer(\n","    model=model,                         # the instantiated 🤗 Transformers model to be trained\n","    args=training_args,                  # training arguments, defined above\n","    train_dataset=train_dataset,         # training dataset\n","    eval_dataset=val_dataset,            # evaluation dataset\n",")\n","\n","# Start the training\n","trainer.train()\n","# Save model\n","model.save_pretrained(output_dir)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"DgjlL6HZuItY"},"source":["## Evaluation (original data)\n"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":88},"id":"j8wK-yCsgLzh","executionInfo":{"status":"ok","timestamp":1620972770294,"user_tz":240,"elapsed":12389,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghc7IMJmHGBHX09cRSdZE-ghxUmylfzPbFKdpxEUQ=s64","userId":"18416188950270533293"}},"outputId":"0632a921-e5c1-4c41-fd59-73c66f9c1f43"},"source":["model = DistilBertForSequenceClassification.from_pretrained(\n","    output_dir, \n","    num_labels=NUM_LABELS,\n","    id2label=idx2label, # use to show text labels\n",")\n","model.eval()\n","evaluator = Trainer(\n","    model=model,                         # the instantiated 🤗 Transformers model to be trained\n","    eval_dataset=val_dataset,             # evaluation dataset\n",")\n","\n","eval_results = evaluator.evaluate()\n","print()\n","for key in ['eval_loss']:\n","    value = eval_results[key]\n","    if type(value) != type(np.array([])):\n","        print(f'{key}:', value)\n","    else:\n","        print(f'{key}:\\n')\n","        for lab, val in zip(label_names, value): \n","            print(f'{lab}:', val)\n","    print()"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='81' max='81' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [81/81 00:09]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","eval_loss: 0.7965028285980225\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":928},"id":"GMvkJGaTgi5L","executionInfo":{"status":"ok","timestamp":1620973330327,"user_tz":240,"elapsed":10598,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghc7IMJmHGBHX09cRSdZE-ghxUmylfzPbFKdpxEUQ=s64","userId":"18416188950270533293"}},"outputId":"0c74e277-e2c2-45b3-991b-29e1cbd316c1"},"source":["model = DistilBertForSequenceClassification.from_pretrained(\n","    output_dir, \n","    num_labels=len(idx2label),\n","    id2label=idx2label, # use to show text labels\n",")\n","model.eval()\n","evaluator = Trainer(\n","    model=model,                         # the instantiated 🤗 Transformers model to be trained\n","    eval_dataset=val_dataset,             # evaluation dataset\n",")\n","\n","eval_results = evaluator.predict(val_dataset)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='81' max='81' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [81/81 00:08]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["PredictionOutput(predictions=array([[-0.51687396, -0.2280793 , -1.1149266 , ..., -0.8874805 ,\n","        -1.0874859 ,  1.2969282 ],\n","       [-0.51687396, -0.2280793 , -1.1149266 , ..., -0.8874805 ,\n","        -1.0874859 ,  1.2969282 ],\n","       [ 2.2525823 ,  3.4094844 , -2.0588784 , ..., -1.9034586 ,\n","         0.22647806, -0.7066332 ],\n","       ...,\n","       [ 6.3853054 ,  0.90108824, -1.087564  , ...,  0.24448201,\n","        -1.1167532 , -2.0328183 ],\n","       [ 3.3649635 , -0.66779125, -0.39822677, ...,  0.53759164,\n","        -0.81244636, -1.6954921 ],\n","       [-1.6453373 , -1.9544014 , -0.5804647 , ...,  1.2760181 ,\n","        -0.55079734,  0.2663226 ]], dtype=float32), label_ids=array([ 5, 11,  0,  1,  0,  9,  9,  0, 10,  4,  1, 10,  0,  4,  9,  9,  1,\n","        1,  0,  1,  1,  0,  1,  0,  0,  1,  1,  1,  1,  0,  1,  1,  1,  9,\n","        0,  9,  0,  1,  0,  9,  0,  2,  1,  6,  0,  1,  0,  0,  1, 10,  4,\n","        9,  0,  0,  2,  0,  0,  0,  3,  1,  1,  5,  5,  2,  3,  7,  7, 11,\n","        9,  7,  9,  0,  8,  1,  4,  4,  2,  8,  1,  5,  9,  1,  0,  0,  1,\n","        9,  0,  4, 11,  0,  0,  0,  0,  0,  1,  3,  5,  0,  5,  9,  5,  1,\n","        1,  5,  1,  0,  1,  8,  9,  1,  9,  0,  1,  5,  5,  5,  2,  3,  9,\n","        0,  1,  1,  9,  4,  1,  1,  8,  9,  0,  1,  1,  1,  6,  8,  0,  0,\n","        0,  1,  3,  7, 11,  9,  2, 11,  4,  1,  0,  9,  0,  1, 10,  1,  4,\n","        9,  5,  1,  1,  0, 11,  2, 10,  1,  5,  9,  0,  1,  1,  1,  0,  2,\n","        9,  7,  6,  0,  1,  9,  8, 11,  9,  1,  1,  0,  1,  8,  0,  9,  1,\n","        1,  1,  0, 10,  4,  0, 10,  0,  1,  9, 11,  8, 11,  1,  9,  5,  7,\n","       11, 11,  9,  0,  0,  1,  9,  0,  8,  1,  0,  1,  5,  0,  1, 10,  1,\n","        1,  0,  5, 11,  8,  9,  9,  5,  9,  9,  2,  8,  0,  0,  0,  1,  1,\n","        4,  4,  8,  1,  8,  1,  4, 11,  9,  8,  0,  0,  9,  0,  5,  0,  0,\n","        7,  0,  9,  0,  9,  1,  1,  8,  0, 10,  1,  2,  8,  0,  2, 11,  0,\n","        0,  0,  1,  2,  8,  0,  0,  1,  0,  0,  1,  5,  1,  9,  7,  0,  0,\n","        5,  3,  3,  8,  1,  1,  0,  1,  8, 10,  3,  4,  5, 11,  9,  9, 11,\n","        5,  8,  8,  0,  1,  0,  1,  5,  1,  0,  2, 11,  5,  2, 11,  7,  9,\n","        9,  9,  9,  5,  7,  1,  1,  1,  1,  9,  0,  1, 10,  0,  0,  0,  8,\n","        2,  8,  1,  1,  7,  4, 11,  0,  9,  9,  1,  8,  5,  1,  5,  0,  4,\n","        3,  4,  2,  3,  0,  8,  0,  7,  8,  0,  1,  2,  9,  0,  0,  1,  8,\n","        5,  5, 10,  0,  1,  0,  0,  6,  0, 10,  0,  1,  0,  1,  0,  1,  0,\n","        0,  1,  9,  0,  1,  5,  7,  0, 11,  4, 11,  9, 10,  7,  1,  0,  8,\n","        0,  0,  0, 10,  1,  7,  0,  0,  1,  0,  0,  1,  8, 11,  5,  5,  5,\n","        9,  0,  1,  0,  1,  0,  0,  4,  9,  0,  1,  1,  3, 11,  0,  0,  0,\n","        8,  8,  1,  1,  1,  0,  1,  0,  4,  5, 11,  9,  0,  0,  1,  3,  4,\n","       11,  9,  0,  0,  1,  1,  1,  2,  4,  8,  9,  9,  0,  1, 10,  8, 11,\n","        7,  9,  0,  0,  1,  1, 11,  1,  8,  2,  1,  0,  1,  2,  8,  0,  6,\n","        7,  0,  9,  8,  1,  0,  0,  1,  0,  0,  6,  1,  1,  0,  1,  1,  1,\n","        1,  2,  0,  0,  3,  0,  8,  1,  0,  1,  9,  0,  0,  0,  1,  1, 10,\n","        2,  5,  7,  9, 11,  1,  0,  1,  1,  7,  9,  0,  0,  1,  8,  7,  5,\n","        0,  9,  1,  9,  0,  0,  9,  0, 10,  1,  5,  8,  5,  4,  0,  0,  1,\n","        4,  1,  0,  0,  2,  9,  0,  0,  0,  4,  1,  1,  4,  7,  9,  5,  0,\n","        0,  0,  1,  1,  1,  5,  8,  8,  8,  4, 11,  7,  8,  1,  4,  0,  0,\n","        0,  0,  1,  0,  0,  0,  1,  4,  8,  2,  8, 11,  9, 11,  0,  1,  9,\n","        1,  1,  7,  0,  3,  8,  1,  5,  7,  1,  0,  1,  0,  1,  1, 10, 11,\n","        9, 10,  0, 10,  4,  9,  9,  0,  1,  0,  4,  8,  8,  0,  1,  1,  0,\n","        0,  7]), metrics={'test_loss': 0.7965028285980225, 'test_runtime': 8.6542, 'test_samples_per_second': 74.877, 'init_mem_cpu_alloc_delta': 0, 'init_mem_gpu_alloc_delta': 263687680, 'init_mem_cpu_peaked_delta': 0, 'init_mem_gpu_peaked_delta': 0, 'test_mem_cpu_alloc_delta': 12017664, 'test_mem_gpu_alloc_delta': 0, 'test_mem_cpu_peaked_delta': 0, 'test_mem_gpu_peaked_delta': 206855680})\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"P4G6TbqCb7fV","executionInfo":{"status":"ok","timestamp":1620973523777,"user_tz":240,"elapsed":459,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghc7IMJmHGBHX09cRSdZE-ghxUmylfzPbFKdpxEUQ=s64","userId":"18416188950270533293"}},"outputId":"7f63bd60-835f-4385-8fbc-eec4297de61c"},"source":["model.to('cpu')\n","\n","# produce one-hot preds \n","y_true = eval_results[1].tolist()\n","y_pred = eval_results[0].argmax(axis=-1).tolist()\n","\n","label_names = list(label2idx.keys())\n","# Print and save classification report\n","print('Validation Flat Accuracy: ', accuracy_score(y_true, y_pred),'\\n')\n","\n","clf_report = classification_report(y_true, y_pred, target_names=label_names)\n","pickle.dump(clf_report, open(output_dir+'/classification_report.txt','wb')) #save report\n","print(clf_report)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Validation Flat Accuracy:  0.7376543209876543 \n","\n","                                      precision    recall  f1-score   support\n","\n","          First Party Collection/Use       0.75      0.72      0.74       176\n","      Third Party Sharing/Collection       0.75      0.81      0.78       158\n","      User Access, Edit and Deletion       0.69      0.75      0.72        24\n","                      Data Retention       0.67      0.29      0.40        14\n","                       Data Security       0.71      0.81      0.76        31\n","International and Specific Audiences       0.81      0.95      0.88        41\n","                        Do Not Track       0.75      0.50      0.60         6\n","                       Policy Change       0.74      0.80      0.77        25\n","                 User Choice/Control       0.65      0.65      0.65        48\n","                Introductory/Generic       0.79      0.72      0.75        72\n","                Practice not covered       0.44      0.38      0.41        21\n","         Privacy contact information       0.74      0.72      0.73        32\n","\n","                            accuracy                           0.74       648\n","                           macro avg       0.71      0.67      0.68       648\n","                        weighted avg       0.74      0.74      0.73       648\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"q0uPXzUQuIta"},"source":["## Attack\n","\n","Finally, let's attack our fine-tuned model. we will create an adversarial version of the validation set and show that the accuracy decreases significantly."]},{"cell_type":"code","metadata":{"id":"pddB_UQQA1Uc"},"source":["adv_valid_set = valid_set.copy()\n","augmenter = textattack.augmentation.recipes.WordNetAugmenter(\n","    pct_words_to_swap=0.1, \n","    transformations_per_example=1\n","    )"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ncu0MWgClvL2","executionInfo":{"status":"ok","timestamp":1621029856814,"user_tz":240,"elapsed":1969766,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"34c402e4-f3c2-4c4a-f9bc-4f5ba6fa2189"},"source":["from tqdm import tqdm\n","for i, s in enumerate(tqdm(adv_valid_set.segment)):\n","    adv_valid_set.iloc[i].segment = augmenter.augment(s)[0]\n","\n","adv_val_encodings = tokenizer(adv_valid_set.segment.to_list(), truncation=True, padding=True)\n","adv_val_dataset = OppDataset(adv_val_encodings, adv_valid_set.label.to_list())"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\n","  0%|          | 0/648 [00:00<?, ?it/s]\u001b[A\n","  0%|          | 1/648 [00:00<03:28,  3.10it/s]\u001b[A\n","  0%|          | 2/648 [00:00<03:38,  2.96it/s]\u001b[A\n","  0%|          | 3/648 [00:02<08:39,  1.24it/s]\u001b[A\n","  1%|          | 4/648 [00:04<10:57,  1.02s/it]\u001b[A\n","  1%|          | 5/648 [00:05<10:44,  1.00s/it]\u001b[A\n","  1%|          | 6/648 [00:05<10:22,  1.03it/s]\u001b[A\n","  1%|          | 7/648 [00:09<17:58,  1.68s/it]\u001b[A\n","  1%|▏         | 9/648 [00:09<12:51,  1.21s/it]\u001b[A\n","  2%|▏         | 11/648 [00:13<14:49,  1.40s/it]\u001b[A\n","  2%|▏         | 12/648 [00:17<22:48,  2.15s/it]\u001b[A\n","  2%|▏         | 13/648 [00:17<17:28,  1.65s/it]\u001b[A\n","  2%|▏         | 14/648 [00:17<13:02,  1.23s/it]\u001b[A\n","  2%|▏         | 15/648 [00:18<09:58,  1.06it/s]\u001b[A\n","  2%|▏         | 16/648 [00:19<11:07,  1.06s/it]\u001b[A\n","  3%|▎         | 17/648 [00:19<08:40,  1.21it/s]\u001b[A\n","  3%|▎         | 19/648 [00:43<43:30,  4.15s/it]\u001b[A\n","  3%|▎         | 20/648 [01:06<1:41:40,  9.71s/it]\u001b[A\n","  3%|▎         | 21/648 [01:06<1:12:42,  6.96s/it]\u001b[A\n","  3%|▎         | 22/648 [01:07<53:48,  5.16s/it]  \u001b[A\n","  4%|▎         | 23/648 [01:08<40:19,  3.87s/it]\u001b[A\n","  4%|▎         | 24/648 [01:08<28:36,  2.75s/it]\u001b[A\n","  4%|▍         | 26/648 [01:08<20:18,  1.96s/it]\u001b[A\n","  4%|▍         | 27/648 [01:10<19:38,  1.90s/it]\u001b[A\n","  4%|▍         | 28/648 [01:22<51:48,  5.01s/it]\u001b[A\n","  4%|▍         | 29/648 [02:10<3:02:33, 17.70s/it]\u001b[A\n","  5%|▍         | 30/648 [02:10<2:08:18, 12.46s/it]\u001b[A\n","  5%|▍         | 31/648 [02:10<1:31:02,  8.85s/it]\u001b[A\n","  5%|▍         | 32/648 [02:12<1:08:53,  6.71s/it]\u001b[A\n","  5%|▌         | 33/648 [02:12<48:55,  4.77s/it]  \u001b[A\n","  5%|▌         | 35/648 [02:15<38:23,  3.76s/it]\u001b[A\n","  6%|▌         | 36/648 [02:18<35:49,  3.51s/it]\u001b[A\n","  6%|▌         | 37/648 [02:19<27:40,  2.72s/it]\u001b[A\n","  6%|▌         | 38/648 [02:20<22:22,  2.20s/it]\u001b[A\n","  6%|▌         | 40/648 [02:21<16:49,  1.66s/it]\u001b[A\n","  6%|▋         | 41/648 [02:25<25:33,  2.53s/it]\u001b[A\n","  6%|▋         | 42/648 [02:26<20:20,  2.01s/it]\u001b[A\n","  7%|▋         | 43/648 [02:31<29:08,  2.89s/it]\u001b[A\n","  7%|▋         | 45/648 [02:38<30:41,  3.05s/it]\u001b[A\n","  7%|▋         | 46/648 [02:45<42:00,  4.19s/it]\u001b[A\n","  7%|▋         | 47/648 [02:46<33:57,  3.39s/it]\u001b[A\n","  7%|▋         | 48/648 [02:49<31:19,  3.13s/it]\u001b[A\n","  8%|▊         | 49/648 [02:49<23:05,  2.31s/it]\u001b[A\n","  8%|▊         | 50/648 [02:50<19:32,  1.96s/it]\u001b[A\n","  8%|▊         | 53/648 [02:52<14:46,  1.49s/it]\u001b[A\n","  8%|▊         | 54/648 [02:56<24:04,  2.43s/it]\u001b[A\n","  8%|▊         | 55/648 [03:01<31:19,  3.17s/it]\u001b[A\n","  9%|▊         | 56/648 [03:06<35:25,  3.59s/it]\u001b[A\n","  9%|▉         | 57/648 [03:06<26:21,  2.68s/it]\u001b[A\n","  9%|▉         | 58/648 [03:07<20:34,  2.09s/it]\u001b[A\n","  9%|▉         | 59/648 [03:08<16:15,  1.66s/it]\u001b[A\n","  9%|▉         | 60/648 [03:08<12:14,  1.25s/it]\u001b[A\n","  9%|▉         | 61/648 [03:09<10:48,  1.10s/it]\u001b[A\n"," 10%|▉         | 63/648 [03:11<11:10,  1.15s/it]\u001b[A\n"," 10%|▉         | 64/648 [03:11<08:12,  1.19it/s]\u001b[A\n"," 10%|█         | 65/648 [03:11<06:07,  1.59it/s]\u001b[A\n"," 10%|█         | 66/648 [03:15<14:39,  1.51s/it]\u001b[A\n"," 10%|█         | 67/648 [03:30<53:04,  5.48s/it]\u001b[A\n"," 10%|█         | 68/648 [03:44<1:18:17,  8.10s/it]\u001b[A\n"," 11%|█         | 69/648 [03:46<1:01:07,  6.33s/it]\u001b[A\n"," 11%|█         | 70/648 [03:47<44:19,  4.60s/it]  \u001b[A\n"," 11%|█         | 71/648 [03:47<32:36,  3.39s/it]\u001b[A\n"," 11%|█         | 72/648 [03:53<39:51,  4.15s/it]\u001b[A\n"," 11%|█▏        | 73/648 [03:55<32:03,  3.35s/it]\u001b[A\n"," 11%|█▏        | 74/648 [03:58<31:46,  3.32s/it]\u001b[A\n"," 12%|█▏        | 75/648 [04:01<30:33,  3.20s/it]\u001b[A\n"," 12%|█▏        | 76/648 [04:01<21:46,  2.28s/it]\u001b[A\n"," 12%|█▏        | 77/648 [04:02<18:41,  1.96s/it]\u001b[A\n"," 12%|█▏        | 79/648 [04:06<18:54,  1.99s/it]\u001b[A\n"," 12%|█▏        | 80/648 [04:10<23:42,  2.51s/it]\u001b[A\n"," 12%|█▎        | 81/648 [04:11<18:33,  1.96s/it]\u001b[A\n"," 13%|█▎        | 82/648 [04:23<47:41,  5.06s/it]\u001b[A\n"," 13%|█▎        | 83/648 [04:24<36:37,  3.89s/it]\u001b[A\n"," 13%|█▎        | 84/648 [04:27<34:02,  3.62s/it]\u001b[A\n"," 13%|█▎        | 85/648 [04:30<32:18,  3.44s/it]\u001b[A\n"," 13%|█▎        | 86/648 [04:31<24:02,  2.57s/it]\u001b[A\n"," 13%|█▎        | 87/648 [04:33<23:27,  2.51s/it]\u001b[A\n"," 14%|█▎        | 88/648 [04:38<30:54,  3.31s/it]\u001b[A\n"," 14%|█▍        | 90/648 [04:41<24:54,  2.68s/it]\u001b[A\n"," 14%|█▍        | 91/648 [04:44<27:17,  2.94s/it]\u001b[A\n"," 14%|█▍        | 92/648 [04:46<22:55,  2.47s/it]\u001b[A\n"," 14%|█▍        | 93/648 [05:01<59:46,  6.46s/it]\u001b[A\n"," 15%|█▍        | 94/648 [05:04<47:58,  5.20s/it]\u001b[A\n"," 15%|█▍        | 95/648 [05:05<38:05,  4.13s/it]\u001b[A\n"," 15%|█▍        | 96/648 [05:06<27:58,  3.04s/it]\u001b[A\n"," 15%|█▍        | 97/648 [05:06<20:49,  2.27s/it]\u001b[A\n"," 15%|█▌        | 98/648 [05:09<21:31,  2.35s/it]\u001b[A\n"," 15%|█▌        | 99/648 [05:11<22:35,  2.47s/it]\u001b[A\n"," 15%|█▌        | 100/648 [05:17<30:17,  3.32s/it]\u001b[A\n"," 16%|█▌        | 101/648 [05:18<25:43,  2.82s/it]\u001b[A\n"," 16%|█▌        | 102/648 [05:23<29:48,  3.28s/it]\u001b[A\n"," 16%|█▌        | 103/648 [05:24<25:08,  2.77s/it]\u001b[A\n"," 16%|█▌        | 104/648 [05:25<18:27,  2.04s/it]\u001b[A\n"," 16%|█▌        | 105/648 [05:26<15:43,  1.74s/it]\u001b[A\n"," 16%|█▋        | 106/648 [05:36<38:41,  4.28s/it]\u001b[A\n"," 17%|█▋        | 107/648 [05:46<53:27,  5.93s/it]\u001b[A\n"," 17%|█▋        | 108/648 [05:56<1:06:13,  7.36s/it]\u001b[A\n"," 17%|█▋        | 109/648 [06:07<1:15:24,  8.39s/it]\u001b[A\n"," 17%|█▋        | 110/648 [06:08<54:07,  6.04s/it]  \u001b[A\n"," 17%|█▋        | 111/648 [06:08<38:32,  4.31s/it]\u001b[A\n"," 17%|█▋        | 112/648 [06:08<27:21,  3.06s/it]\u001b[A\n"," 18%|█▊        | 114/648 [06:11<23:17,  2.62s/it]\u001b[A\n"," 18%|█▊        | 115/648 [06:14<23:02,  2.59s/it]\u001b[A\n"," 18%|█▊        | 116/648 [06:15<18:47,  2.12s/it]\u001b[A\n"," 18%|█▊        | 117/648 [06:24<36:56,  4.17s/it]\u001b[A\n"," 18%|█▊        | 118/648 [06:32<47:40,  5.40s/it]\u001b[A\n"," 18%|█▊        | 119/648 [06:32<34:07,  3.87s/it]\u001b[A\n"," 19%|█▊        | 120/648 [06:33<24:33,  2.79s/it]\u001b[A\n"," 19%|█▊        | 121/648 [06:40<36:41,  4.18s/it]\u001b[A\n"," 19%|█▉        | 122/648 [06:45<37:34,  4.29s/it]\u001b[A\n"," 19%|█▉        | 124/648 [06:54<38:26,  4.40s/it]\u001b[A\n"," 19%|█▉        | 125/648 [06:56<32:42,  3.75s/it]\u001b[A\n"," 19%|█▉        | 126/648 [06:57<24:05,  2.77s/it]\u001b[A\n"," 20%|█▉        | 127/648 [07:00<24:25,  2.81s/it]\u001b[A\n"," 20%|██        | 131/648 [07:00<17:21,  2.01s/it]\u001b[A\n"," 20%|██        | 132/648 [07:03<19:46,  2.30s/it]\u001b[A\n"," 21%|██        | 133/648 [07:04<16:04,  1.87s/it]\u001b[A\n"," 21%|██        | 134/648 [07:05<13:22,  1.56s/it]\u001b[A\n"," 21%|██        | 137/648 [07:06<10:14,  1.20s/it]\u001b[A\n"," 21%|██▏       | 138/648 [07:07<09:40,  1.14s/it]\u001b[A\n"," 21%|██▏       | 139/648 [07:08<09:21,  1.10s/it]\u001b[A\n"," 22%|██▏       | 140/648 [07:09<07:52,  1.08it/s]\u001b[A\n"," 22%|██▏       | 141/648 [07:09<07:01,  1.20it/s]\u001b[A\n"," 22%|██▏       | 143/648 [07:10<05:38,  1.49it/s]\u001b[A\n"," 22%|██▏       | 144/648 [07:10<05:22,  1.56it/s]\u001b[A\n"," 22%|██▏       | 145/648 [07:11<06:10,  1.36it/s]\u001b[A\n"," 23%|██▎       | 146/648 [07:12<04:58,  1.68it/s]\u001b[A\n"," 23%|██▎       | 147/648 [07:12<04:07,  2.02it/s]\u001b[A\n"," 23%|██▎       | 149/648 [07:12<03:16,  2.54it/s]\u001b[A\n"," 23%|██▎       | 151/648 [07:12<02:39,  3.12it/s]\u001b[A\n"," 23%|██▎       | 152/648 [07:13<03:07,  2.65it/s]\u001b[A\n"," 24%|██▎       | 153/648 [07:13<02:27,  3.37it/s]\u001b[A\n"," 24%|██▍       | 154/648 [07:13<02:20,  3.53it/s]\u001b[A\n"," 24%|██▍       | 155/648 [07:14<02:31,  3.26it/s]\u001b[A\n"," 24%|██▍       | 156/648 [07:14<03:06,  2.64it/s]\u001b[A\n"," 24%|██▍       | 157/648 [07:14<02:33,  3.19it/s]\u001b[A\n"," 24%|██▍       | 158/648 [07:24<24:39,  3.02s/it]\u001b[A\n"," 25%|██▍       | 159/648 [07:24<18:00,  2.21s/it]\u001b[A\n"," 25%|██▍       | 160/648 [07:26<17:59,  2.21s/it]\u001b[A\n"," 25%|██▍       | 161/648 [07:28<18:00,  2.22s/it]\u001b[A\n"," 25%|██▌       | 162/648 [07:29<13:14,  1.64s/it]\u001b[A\n"," 25%|██▌       | 163/648 [07:29<09:54,  1.23s/it]\u001b[A\n"," 25%|██▌       | 165/648 [07:30<07:41,  1.05it/s]\u001b[A\n"," 26%|██▌       | 166/648 [07:39<28:18,  3.52s/it]\u001b[A\n"," 26%|██▌       | 167/648 [07:41<24:12,  3.02s/it]\u001b[A\n"," 26%|██▌       | 168/648 [07:42<18:29,  2.31s/it]\u001b[A\n"," 26%|██▌       | 169/648 [07:42<14:02,  1.76s/it]\u001b[A\n"," 26%|██▌       | 170/648 [07:43<11:52,  1.49s/it]\u001b[A\n"," 26%|██▋       | 171/648 [07:43<08:39,  1.09s/it]\u001b[A\n"," 27%|██▋       | 173/648 [07:43<06:16,  1.26it/s]\u001b[A\n"," 27%|██▋       | 174/648 [07:44<04:53,  1.62it/s]\u001b[A\n"," 27%|██▋       | 175/648 [07:44<03:55,  2.01it/s]\u001b[A\n"," 27%|██▋       | 176/648 [07:45<04:34,  1.72it/s]\u001b[A\n"," 27%|██▋       | 177/648 [07:49<12:52,  1.64s/it]\u001b[A\n"," 27%|██▋       | 178/648 [07:49<09:17,  1.19s/it]\u001b[A\n"," 28%|██▊       | 179/648 [07:49<06:44,  1.16it/s]\u001b[A\n"," 28%|██▊       | 180/648 [07:50<07:54,  1.01s/it]\u001b[A\n"," 28%|██▊       | 181/648 [07:58<24:31,  3.15s/it]\u001b[A\n"," 28%|██▊       | 182/648 [07:59<18:43,  2.41s/it]\u001b[A\n"," 28%|██▊       | 183/648 [08:00<15:01,  1.94s/it]\u001b[A\n"," 28%|██▊       | 184/648 [08:01<12:55,  1.67s/it]\u001b[A\n"," 29%|██▊       | 185/648 [08:01<09:31,  1.23s/it]\u001b[A\n"," 29%|██▉       | 187/648 [08:22<30:52,  4.02s/it]\u001b[A\n"," 29%|██▉       | 188/648 [08:22<22:11,  2.89s/it]\u001b[A\n"," 29%|██▉       | 189/648 [08:23<16:03,  2.10s/it]\u001b[A\n"," 29%|██▉       | 190/648 [08:26<17:39,  2.31s/it]\u001b[A\n"," 30%|██▉       | 192/648 [08:26<12:58,  1.71s/it]\u001b[A\n"," 30%|██▉       | 193/648 [08:26<09:22,  1.24s/it]\u001b[A\n"," 30%|██▉       | 194/648 [08:26<07:02,  1.07it/s]\u001b[A\n"," 30%|███       | 195/648 [08:27<07:11,  1.05it/s]\u001b[A\n"," 30%|███       | 196/648 [08:28<07:11,  1.05it/s]\u001b[A\n"," 31%|███       | 198/648 [08:29<05:25,  1.38it/s]\u001b[A\n"," 31%|███       | 199/648 [08:30<05:43,  1.31it/s]\u001b[A\n"," 31%|███       | 200/648 [08:31<06:06,  1.22it/s]\u001b[A\n"," 31%|███       | 201/648 [08:35<13:12,  1.77s/it]\u001b[A\n"," 31%|███▏      | 203/648 [08:35<09:20,  1.26s/it]\u001b[A\n"," 31%|███▏      | 204/648 [08:36<09:48,  1.33s/it]\u001b[A\n"," 32%|███▏      | 205/648 [08:38<09:55,  1.35s/it]\u001b[A\n"," 32%|███▏      | 206/648 [08:38<07:38,  1.04s/it]\u001b[A\n"," 32%|███▏      | 208/648 [09:54<1:28:57, 12.13s/it]\u001b[A\n"," 32%|███▏      | 209/648 [10:00<1:15:00, 10.25s/it]\u001b[A\n"," 32%|███▏      | 210/648 [10:06<1:06:18,  9.08s/it]\u001b[A\n"," 33%|███▎      | 211/648 [10:06<46:48,  6.43s/it]  \u001b[A\n"," 33%|███▎      | 212/648 [10:07<33:06,  4.56s/it]\u001b[A\n"," 33%|███▎      | 213/648 [10:07<23:29,  3.24s/it]\u001b[A\n"," 33%|███▎      | 214/648 [10:07<16:43,  2.31s/it]\u001b[A\n"," 34%|███▎      | 218/648 [10:07<11:45,  1.64s/it]\u001b[A\n"," 34%|███▍      | 219/648 [10:07<08:27,  1.18s/it]\u001b[A\n"," 34%|███▍      | 221/648 [10:07<06:00,  1.18it/s]\u001b[A\n"," 34%|███▍      | 223/648 [10:15<11:57,  1.69s/it]\u001b[A\n"," 35%|███▌      | 227/648 [10:18<09:58,  1.42s/it]\u001b[A\n"," 35%|███▌      | 228/648 [10:18<07:52,  1.12s/it]\u001b[A\n"," 35%|███▌      | 230/648 [10:38<26:18,  3.78s/it]\u001b[A\n"," 36%|███▌      | 231/648 [10:39<19:27,  2.80s/it]\u001b[A\n"," 36%|███▌      | 232/648 [10:42<20:42,  2.99s/it]\u001b[A\n"," 36%|███▌      | 233/648 [10:46<21:32,  3.11s/it]\u001b[A\n"," 36%|███▌      | 234/648 [10:52<28:26,  4.12s/it]\u001b[A\n"," 36%|███▋      | 235/648 [10:53<22:09,  3.22s/it]\u001b[A\n"," 36%|███▋      | 236/648 [10:55<19:37,  2.86s/it]\u001b[A\n"," 37%|███▋      | 237/648 [11:06<35:14,  5.15s/it]\u001b[A\n"," 37%|███▋      | 238/648 [11:09<31:06,  4.55s/it]\u001b[A\n"," 37%|███▋      | 239/648 [11:12<28:10,  4.13s/it]\u001b[A\n"," 37%|███▋      | 240/648 [11:13<21:29,  3.16s/it]\u001b[A\n"," 37%|███▋      | 241/648 [11:14<17:24,  2.57s/it]\u001b[A\n"," 37%|███▋      | 242/648 [11:18<20:06,  2.97s/it]\u001b[A\n"," 38%|███▊      | 243/648 [11:22<21:50,  3.24s/it]\u001b[A\n"," 38%|███▊      | 244/648 [11:23<16:33,  2.46s/it]\u001b[A\n"," 38%|███▊      | 245/648 [11:24<13:43,  2.04s/it]\u001b[A\n"," 38%|███▊      | 248/648 [11:24<09:38,  1.45s/it]\u001b[A\n"," 38%|███▊      | 249/648 [11:25<08:54,  1.34s/it]\u001b[A\n"," 39%|███▊      | 250/648 [11:25<07:17,  1.10s/it]\u001b[A\n"," 39%|███▊      | 251/648 [11:26<06:10,  1.07it/s]\u001b[A\n"," 39%|███▉      | 252/648 [11:26<04:47,  1.38it/s]\u001b[A\n"," 39%|███▉      | 253/648 [11:27<04:18,  1.53it/s]\u001b[A\n"," 39%|███▉      | 254/648 [11:27<03:57,  1.66it/s]\u001b[A\n"," 39%|███▉      | 255/648 [11:29<06:27,  1.02it/s]\u001b[A\n"," 40%|███▉      | 256/648 [11:29<05:08,  1.27it/s]\u001b[A\n"," 40%|███▉      | 257/648 [11:30<03:51,  1.69it/s]\u001b[A\n"," 40%|███▉      | 259/648 [11:30<03:00,  2.16it/s]\u001b[A\n"," 40%|████      | 260/648 [11:31<04:51,  1.33it/s]\u001b[A\n"," 40%|████      | 261/648 [11:33<06:16,  1.03it/s]\u001b[A\n"," 40%|████      | 262/648 [11:33<04:45,  1.35it/s]\u001b[A\n"," 41%|████      | 263/648 [11:33<03:33,  1.80it/s]\u001b[A\n"," 41%|████      | 264/648 [11:34<03:17,  1.95it/s]\u001b[A\n"," 41%|████      | 265/648 [11:34<03:08,  2.03it/s]\u001b[A\n"," 41%|████      | 266/648 [11:35<04:27,  1.43it/s]\u001b[A\n"," 41%|████      | 267/648 [11:49<28:51,  4.54s/it]\u001b[A\n"," 41%|████▏     | 268/648 [12:01<43:47,  6.91s/it]\u001b[A\n"," 42%|████▏     | 270/648 [12:01<30:36,  4.86s/it]\u001b[A\n"," 42%|████▏     | 272/648 [12:13<32:22,  5.17s/it]\u001b[A\n"," 42%|████▏     | 273/648 [12:15<26:40,  4.27s/it]\u001b[A\n"," 42%|████▏     | 275/648 [12:30<32:29,  5.23s/it]\u001b[A\n"," 43%|████▎     | 276/648 [12:44<49:25,  7.97s/it]\u001b[A\n"," 43%|████▎     | 277/648 [12:59<1:02:23, 10.09s/it]\u001b[A\n"," 43%|████▎     | 279/648 [13:00<43:37,  7.09s/it]  \u001b[A\n"," 43%|████▎     | 280/648 [13:00<30:45,  5.01s/it]\u001b[A\n"," 43%|████▎     | 281/648 [13:00<22:21,  3.65s/it]\u001b[A\n"," 44%|████▎     | 283/648 [13:23<36:18,  5.97s/it]\u001b[A\n"," 44%|████▍     | 284/648 [13:24<27:44,  4.57s/it]\u001b[A\n"," 44%|████▍     | 285/648 [13:25<21:10,  3.50s/it]\u001b[A\n"," 44%|████▍     | 286/648 [13:26<16:35,  2.75s/it]\u001b[A\n"," 44%|████▍     | 287/648 [13:28<15:11,  2.53s/it]\u001b[A\n"," 44%|████▍     | 288/648 [13:37<26:50,  4.47s/it]\u001b[A\n"," 45%|████▍     | 289/648 [13:51<43:59,  7.35s/it]\u001b[A\n"," 45%|████▍     | 290/648 [14:05<55:31,  9.31s/it]\u001b[A\n"," 45%|████▍     | 291/648 [14:07<42:33,  7.15s/it]\u001b[A\n"," 45%|████▌     | 293/648 [14:11<32:39,  5.52s/it]\u001b[A\n"," 45%|████▌     | 294/648 [15:38<2:56:08, 29.85s/it]\u001b[A\n"," 46%|████▌     | 295/648 [15:40<2:07:57, 21.75s/it]\u001b[A\n"," 46%|████▌     | 296/648 [15:44<1:35:37, 16.30s/it]\u001b[A\n"," 46%|████▌     | 297/648 [15:49<1:15:59, 12.99s/it]\u001b[A\n"," 46%|████▌     | 298/648 [15:50<53:52,  9.23s/it]  \u001b[A\n"," 46%|████▌     | 299/648 [15:50<38:58,  6.70s/it]\u001b[A\n"," 46%|████▋     | 300/648 [15:55<35:50,  6.18s/it]\u001b[A\n"," 46%|████▋     | 301/648 [16:05<40:54,  7.07s/it]\u001b[A\n"," 47%|████▋     | 302/648 [16:09<36:01,  6.25s/it]\u001b[A\n"," 47%|████▋     | 303/648 [16:10<26:53,  4.68s/it]\u001b[A\n"," 47%|████▋     | 306/648 [16:13<20:17,  3.56s/it]\u001b[A\n"," 47%|████▋     | 307/648 [16:13<14:46,  2.60s/it]\u001b[A\n"," 48%|████▊     | 310/648 [16:13<10:19,  1.83s/it]\u001b[A\n"," 48%|████▊     | 313/648 [16:14<07:32,  1.35s/it]\u001b[A\n"," 48%|████▊     | 314/648 [16:15<06:11,  1.11s/it]\u001b[A\n"," 49%|████▊     | 315/648 [16:22<17:36,  3.17s/it]\u001b[A\n"," 49%|████▉     | 317/648 [16:23<12:20,  2.24s/it]\u001b[A\n"," 49%|████▉     | 319/648 [16:24<09:29,  1.73s/it]\u001b[A\n"," 49%|████▉     | 320/648 [16:27<12:17,  2.25s/it]\u001b[A\n"," 50%|████▉     | 321/648 [16:28<10:34,  1.94s/it]\u001b[A\n"," 50%|████▉     | 322/648 [16:29<07:48,  1.44s/it]\u001b[A\n"," 50%|████▉     | 323/648 [16:29<06:23,  1.18s/it]\u001b[A\n"," 50%|█████     | 325/648 [16:30<05:11,  1.04it/s]\u001b[A\n"," 50%|█████     | 326/648 [16:32<07:17,  1.36s/it]\u001b[A\n"," 50%|█████     | 327/648 [16:33<06:07,  1.15s/it]\u001b[A\n"," 51%|█████     | 328/648 [16:38<12:19,  2.31s/it]\u001b[A\n"," 51%|█████     | 329/648 [16:39<10:12,  1.92s/it]\u001b[A\n"," 51%|█████     | 330/648 [16:45<17:02,  3.21s/it]\u001b[A\n"," 51%|█████     | 331/648 [16:47<14:10,  2.68s/it]\u001b[A\n"," 51%|█████     | 332/648 [16:47<10:13,  1.94s/it]\u001b[A\n"," 52%|█████▏    | 334/648 [16:49<08:24,  1.61s/it]\u001b[A\n"," 52%|█████▏    | 335/648 [16:51<09:15,  1.77s/it]\u001b[A\n"," 52%|█████▏    | 336/648 [16:53<09:55,  1.91s/it]\u001b[A\n"," 52%|█████▏    | 337/648 [17:04<23:54,  4.61s/it]\u001b[A\n"," 52%|█████▏    | 339/648 [17:08<19:28,  3.78s/it]\u001b[A\n"," 52%|█████▏    | 340/648 [17:08<14:03,  2.74s/it]\u001b[A\n"," 53%|█████▎    | 342/648 [17:08<09:59,  1.96s/it]\u001b[A\n"," 53%|█████▎    | 343/648 [17:09<07:27,  1.47s/it]\u001b[A\n"," 53%|█████▎    | 344/648 [17:24<29:03,  5.74s/it]\u001b[A\n"," 53%|█████▎    | 345/648 [17:41<46:16,  9.16s/it]\u001b[A\n"," 54%|█████▎    | 347/648 [17:42<32:26,  6.47s/it]\u001b[A\n"," 54%|█████▎    | 348/648 [17:42<23:30,  4.70s/it]\u001b[A\n"," 54%|█████▍    | 349/648 [17:44<18:20,  3.68s/it]\u001b[A\n"," 54%|█████▍    | 350/648 [17:44<13:04,  2.63s/it]\u001b[A\n"," 54%|█████▍    | 351/648 [17:46<12:55,  2.61s/it]\u001b[A\n"," 54%|█████▍    | 352/648 [17:48<11:05,  2.25s/it]\u001b[A\n"," 54%|█████▍    | 353/648 [17:50<11:24,  2.32s/it]\u001b[A\n"," 55%|█████▍    | 354/648 [17:51<08:37,  1.76s/it]\u001b[A\n"," 55%|█████▍    | 355/648 [17:53<08:48,  1.80s/it]\u001b[A\n"," 55%|█████▍    | 356/648 [17:55<09:53,  2.03s/it]\u001b[A\n"," 55%|█████▌    | 357/648 [18:05<20:59,  4.33s/it]\u001b[A\n"," 55%|█████▌    | 358/648 [18:06<15:40,  3.24s/it]\u001b[A\n"," 55%|█████▌    | 359/648 [18:06<12:02,  2.50s/it]\u001b[A\n"," 56%|█████▌    | 360/648 [18:09<12:39,  2.64s/it]\u001b[A\n"," 56%|█████▌    | 361/648 [18:12<12:52,  2.69s/it]\u001b[A\n"," 56%|█████▌    | 362/648 [18:13<09:46,  2.05s/it]\u001b[A\n"," 56%|█████▌    | 363/648 [18:13<07:04,  1.49s/it]\u001b[A\n"," 56%|█████▌    | 364/648 [18:13<05:16,  1.11s/it]\u001b[A\n"," 56%|█████▋    | 365/648 [18:13<04:09,  1.14it/s]\u001b[A\n"," 56%|█████▋    | 366/648 [18:14<03:24,  1.38it/s]\u001b[A\n"," 57%|█████▋    | 367/648 [18:14<02:48,  1.67it/s]\u001b[A\n"," 57%|█████▋    | 368/648 [18:14<02:31,  1.85it/s]\u001b[A\n"," 57%|█████▋    | 370/648 [18:16<02:52,  1.61it/s]\u001b[A\n"," 57%|█████▋    | 372/648 [18:35<15:02,  3.27s/it]\u001b[A\n"," 58%|█████▊    | 373/648 [18:54<36:37,  7.99s/it]\u001b[A\n"," 58%|█████▊    | 374/648 [18:55<26:49,  5.88s/it]\u001b[A\n"," 58%|█████▊    | 375/648 [18:56<19:28,  4.28s/it]\u001b[A\n"," 58%|█████▊    | 376/648 [19:36<1:08:34, 15.13s/it]\u001b[A\n"," 58%|█████▊    | 378/648 [19:37<48:09, 10.70s/it]  \u001b[A\n"," 58%|█████▊    | 379/648 [19:37<34:35,  7.72s/it]\u001b[A\n"," 59%|█████▊    | 380/648 [19:38<24:31,  5.49s/it]\u001b[A\n"," 59%|█████▉    | 381/648 [19:39<19:10,  4.31s/it]\u001b[A\n"," 59%|█████▉    | 382/648 [19:41<15:25,  3.48s/it]\u001b[A\n"," 59%|█████▉    | 383/648 [19:41<11:19,  2.56s/it]\u001b[A\n"," 59%|█████▉    | 385/648 [19:42<08:14,  1.88s/it]\u001b[A\n"," 60%|█████▉    | 386/648 [19:45<09:14,  2.11s/it]\u001b[A\n"," 60%|█████▉    | 387/648 [19:45<07:34,  1.74s/it]\u001b[A\n"," 60%|█████▉    | 388/648 [19:46<06:27,  1.49s/it]\u001b[A\n"," 60%|██████    | 389/648 [19:47<04:49,  1.12s/it]\u001b[A\n"," 60%|██████    | 390/648 [19:47<03:41,  1.17it/s]\u001b[A\n"," 60%|██████    | 392/648 [19:50<04:29,  1.05s/it]\u001b[A\n"," 61%|██████    | 393/648 [19:53<07:16,  1.71s/it]\u001b[A\n"," 61%|██████    | 394/648 [19:54<06:42,  1.58s/it]\u001b[A\n"," 61%|██████    | 395/648 [19:55<05:04,  1.20s/it]\u001b[A\n"," 61%|██████    | 396/648 [19:56<05:44,  1.37s/it]\u001b[A\n"," 61%|██████▏   | 397/648 [19:57<04:33,  1.09s/it]\u001b[A\n"," 61%|██████▏   | 398/648 [19:59<05:25,  1.30s/it]\u001b[A\n"," 62%|██████▏   | 400/648 [20:00<04:29,  1.09s/it]\u001b[A\n"," 62%|██████▏   | 401/648 [20:00<03:39,  1.13it/s]\u001b[A\n"," 62%|██████▏   | 402/648 [20:01<03:03,  1.34it/s]\u001b[A\n"," 62%|██████▏   | 403/648 [20:06<08:27,  2.07s/it]\u001b[A\n"," 62%|██████▏   | 404/648 [20:11<12:28,  3.07s/it]\u001b[A\n"," 62%|██████▎   | 405/648 [20:12<09:06,  2.25s/it]\u001b[A\n"," 63%|██████▎   | 406/648 [20:12<06:47,  1.68s/it]\u001b[A\n"," 63%|██████▎   | 407/648 [20:12<04:57,  1.23s/it]\u001b[A\n"," 63%|██████▎   | 408/648 [20:14<06:13,  1.55s/it]\u001b[A\n"," 63%|██████▎   | 410/648 [20:15<04:27,  1.13s/it]\u001b[A\n"," 63%|██████▎   | 411/648 [20:15<03:20,  1.18it/s]\u001b[A\n"," 64%|██████▎   | 412/648 [20:18<05:48,  1.48s/it]\u001b[A\n"," 64%|██████▎   | 413/648 [20:21<07:22,  1.88s/it]\u001b[A\n"," 64%|██████▍   | 414/648 [20:21<05:22,  1.38s/it]\u001b[A\n"," 64%|██████▍   | 416/648 [20:39<14:28,  3.74s/it]\u001b[A\n"," 64%|██████▍   | 417/648 [20:57<30:53,  8.02s/it]\u001b[A\n"," 65%|██████▍   | 418/648 [20:58<21:52,  5.71s/it]\u001b[A\n"," 65%|██████▍   | 419/648 [21:09<28:35,  7.49s/it]\u001b[A\n"," 65%|██████▍   | 420/648 [21:21<33:11,  8.73s/it]\u001b[A\n"," 65%|██████▍   | 421/648 [21:23<25:08,  6.65s/it]\u001b[A\n"," 65%|██████▌   | 422/648 [21:24<19:26,  5.16s/it]\u001b[A\n"," 65%|██████▌   | 423/648 [21:26<15:46,  4.21s/it]\u001b[A\n"," 65%|██████▌   | 424/648 [22:06<55:48, 14.95s/it]\u001b[A\n"," 66%|██████▌   | 425/648 [22:46<1:22:36, 22.23s/it]\u001b[A\n"," 66%|██████▌   | 427/648 [22:48<58:28, 15.88s/it]  \u001b[A\n"," 66%|██████▌   | 428/648 [22:50<42:58, 11.72s/it]\u001b[A\n"," 66%|██████▌   | 429/648 [22:51<31:29,  8.63s/it]\u001b[A\n"," 66%|██████▋   | 430/648 [22:51<22:14,  6.12s/it]\u001b[A\n"," 67%|██████▋   | 431/648 [22:53<17:21,  4.80s/it]\u001b[A\n"," 67%|██████▋   | 432/648 [22:57<16:31,  4.59s/it]\u001b[A\n"," 67%|██████▋   | 433/648 [22:58<12:37,  3.52s/it]\u001b[A\n"," 67%|██████▋   | 435/648 [22:59<09:13,  2.60s/it]\u001b[A\n"," 67%|██████▋   | 436/648 [23:00<07:26,  2.11s/it]\u001b[A\n"," 67%|██████▋   | 437/648 [23:01<05:57,  1.69s/it]\u001b[A\n"," 68%|██████▊   | 438/648 [23:04<07:11,  2.06s/it]\u001b[A\n"," 68%|██████▊   | 439/648 [23:04<05:07,  1.47s/it]\u001b[A\n"," 68%|██████▊   | 440/648 [23:07<06:45,  1.95s/it]\u001b[A\n"," 68%|██████▊   | 443/648 [23:08<04:58,  1.46s/it]\u001b[A\n"," 69%|██████▊   | 444/648 [23:14<09:49,  2.89s/it]\u001b[A\n"," 69%|██████▊   | 445/648 [23:14<07:02,  2.08s/it]\u001b[A\n"," 69%|██████▉   | 446/648 [23:14<05:07,  1.52s/it]\u001b[A\n"," 69%|██████▉   | 447/648 [23:15<03:43,  1.11s/it]\u001b[A\n"," 69%|██████▉   | 448/648 [23:16<04:24,  1.32s/it]\u001b[A\n"," 69%|██████▉   | 449/648 [23:18<05:01,  1.52s/it]\u001b[A\n"," 69%|██████▉   | 450/648 [23:40<24:40,  7.48s/it]\u001b[A\n"," 70%|██████▉   | 451/648 [23:40<17:45,  5.41s/it]\u001b[A\n"," 70%|██████▉   | 452/648 [23:42<14:06,  4.32s/it]\u001b[A\n"," 70%|██████▉   | 453/648 [23:44<11:39,  3.59s/it]\u001b[A\n"," 70%|███████   | 454/648 [23:44<08:30,  2.63s/it]\u001b[A\n"," 70%|███████   | 456/648 [24:07<16:54,  5.29s/it]\u001b[A\n"," 71%|███████   | 457/648 [24:09<12:51,  4.04s/it]\u001b[A\n"," 71%|███████   | 458/648 [24:12<11:53,  3.75s/it]\u001b[A\n"," 71%|███████   | 459/648 [24:15<11:10,  3.55s/it]\u001b[A\n"," 71%|███████   | 460/648 [24:19<11:25,  3.65s/it]\u001b[A\n"," 71%|███████   | 461/648 [24:19<08:06,  2.60s/it]\u001b[A\n"," 71%|███████▏  | 462/648 [24:19<06:06,  1.97s/it]\u001b[A\n"," 71%|███████▏  | 463/648 [24:19<04:26,  1.44s/it]\u001b[A\n"," 72%|███████▏  | 465/648 [24:20<03:28,  1.14s/it]\u001b[A\n"," 72%|███████▏  | 466/648 [24:21<02:42,  1.12it/s]\u001b[A\n"," 72%|███████▏  | 467/648 [24:21<02:12,  1.37it/s]\u001b[A\n"," 72%|███████▏  | 468/648 [24:21<01:51,  1.61it/s]\u001b[A\n"," 72%|███████▏  | 469/648 [24:22<01:49,  1.63it/s]\u001b[A\n"," 73%|███████▎  | 470/648 [24:24<02:40,  1.11it/s]\u001b[A\n"," 73%|███████▎  | 471/648 [24:24<02:06,  1.40it/s]\u001b[A\n"," 73%|███████▎  | 472/648 [24:24<02:00,  1.46it/s]\u001b[A\n"," 73%|███████▎  | 473/648 [24:25<02:21,  1.24it/s]\u001b[A\n"," 73%|███████▎  | 475/648 [24:26<01:45,  1.64it/s]\u001b[A\n"," 73%|███████▎  | 476/648 [24:26<01:27,  1.97it/s]\u001b[A\n"," 74%|███████▎  | 477/648 [24:40<13:10,  4.62s/it]\u001b[A\n"," 74%|███████▍  | 478/648 [24:55<21:36,  7.62s/it]\u001b[A\n"," 74%|███████▍  | 479/648 [24:57<16:26,  5.83s/it]\u001b[A\n"," 74%|███████▍  | 480/648 [24:58<12:41,  4.53s/it]\u001b[A\n"," 74%|███████▍  | 481/648 [25:14<22:21,  8.03s/it]\u001b[A\n"," 74%|███████▍  | 482/648 [25:19<19:48,  7.16s/it]\u001b[A\n"," 75%|███████▍  | 483/648 [25:25<18:33,  6.75s/it]\u001b[A\n"," 75%|███████▍  | 484/648 [25:28<15:21,  5.62s/it]\u001b[A\n"," 75%|███████▍  | 485/648 [25:28<10:48,  3.98s/it]\u001b[A\n"," 75%|███████▌  | 486/648 [25:30<08:43,  3.23s/it]\u001b[A\n"," 75%|███████▌  | 487/648 [25:32<07:51,  2.93s/it]\u001b[A\n"," 75%|███████▌  | 488/648 [25:35<08:12,  3.08s/it]\u001b[A\n"," 75%|███████▌  | 489/648 [25:39<08:30,  3.21s/it]\u001b[A\n"," 76%|███████▌  | 490/648 [25:39<06:00,  2.28s/it]\u001b[A\n"," 76%|███████▌  | 491/648 [25:41<05:38,  2.16s/it]\u001b[A\n"," 76%|███████▌  | 492/648 [26:05<22:53,  8.81s/it]\u001b[A\n"," 76%|███████▌  | 494/648 [26:07<16:36,  6.47s/it]\u001b[A\n"," 76%|███████▋  | 495/648 [26:09<12:32,  4.92s/it]\u001b[A\n"," 77%|███████▋  | 498/648 [26:24<12:30,  5.00s/it]\u001b[A\n"," 77%|███████▋  | 499/648 [26:24<08:48,  3.55s/it]\u001b[A\n"," 77%|███████▋  | 500/648 [26:25<06:16,  2.55s/it]\u001b[A\n"," 77%|███████▋  | 501/648 [26:25<04:30,  1.84s/it]\u001b[A\n"," 77%|███████▋  | 502/648 [26:25<03:14,  1.33s/it]\u001b[A\n"," 78%|███████▊  | 503/648 [26:29<05:16,  2.18s/it]\u001b[A\n"," 78%|███████▊  | 504/648 [26:33<06:17,  2.62s/it]\u001b[A\n"," 78%|███████▊  | 505/648 [26:33<04:41,  1.97s/it]\u001b[A\n"," 78%|███████▊  | 506/648 [26:33<03:22,  1.42s/it]\u001b[A\n"," 78%|███████▊  | 507/648 [26:34<02:48,  1.19s/it]\u001b[A\n"," 78%|███████▊  | 508/648 [26:34<02:06,  1.11it/s]\u001b[A\n"," 79%|███████▉  | 511/648 [26:36<01:47,  1.27it/s]\u001b[A\n"," 79%|███████▉  | 513/648 [26:37<01:46,  1.26it/s]\u001b[A\n"," 79%|███████▉  | 515/648 [26:37<01:16,  1.74it/s]\u001b[A\n"," 80%|███████▉  | 516/648 [26:38<01:29,  1.48it/s]\u001b[A\n"," 80%|███████▉  | 517/648 [26:39<01:06,  1.97it/s]\u001b[A\n"," 80%|███████▉  | 518/648 [26:39<01:06,  1.94it/s]\u001b[A\n"," 80%|████████  | 519/648 [26:39<00:56,  2.29it/s]\u001b[A\n"," 80%|████████  | 520/648 [26:40<01:01,  2.09it/s]\u001b[A\n"," 80%|████████  | 521/648 [26:42<02:09,  1.02s/it]\u001b[A\n"," 81%|████████  | 522/648 [26:42<01:38,  1.28it/s]\u001b[A\n"," 81%|████████  | 523/648 [26:43<01:34,  1.32it/s]\u001b[A\n"," 81%|████████  | 524/648 [26:43<01:15,  1.65it/s]\u001b[A\n"," 81%|████████  | 525/648 [26:44<01:02,  1.98it/s]\u001b[A\n"," 81%|████████  | 526/648 [26:44<00:49,  2.46it/s]\u001b[A\n"," 81%|████████▏ | 527/648 [26:45<01:17,  1.56it/s]\u001b[A\n"," 81%|████████▏ | 528/648 [27:17<20:11, 10.10s/it]\u001b[A\n"," 82%|████████▏ | 529/648 [27:18<14:15,  7.19s/it]\u001b[A\n"," 82%|████████▏ | 532/648 [27:18<09:49,  5.08s/it]\u001b[A\n"," 82%|████████▏ | 533/648 [27:18<06:54,  3.60s/it]\u001b[A\n"," 82%|████████▏ | 534/648 [27:21<06:17,  3.31s/it]\u001b[A\n"," 83%|████████▎ | 535/648 [27:23<05:52,  3.12s/it]\u001b[A\n"," 83%|████████▎ | 536/648 [27:27<06:17,  3.37s/it]\u001b[A\n"," 83%|████████▎ | 537/648 [27:28<04:44,  2.56s/it]\u001b[A\n"," 83%|████████▎ | 538/648 [27:38<08:55,  4.87s/it]\u001b[A\n"," 83%|████████▎ | 539/648 [27:40<06:53,  3.79s/it]\u001b[A\n"," 83%|████████▎ | 540/648 [27:40<05:12,  2.90s/it]\u001b[A\n"," 83%|████████▎ | 541/648 [27:46<06:30,  3.65s/it]\u001b[A\n"," 84%|████████▎ | 542/648 [27:47<04:58,  2.81s/it]\u001b[A\n"," 84%|████████▍ | 543/648 [27:48<03:52,  2.22s/it]\u001b[A\n"," 84%|████████▍ | 544/648 [27:49<03:30,  2.02s/it]\u001b[A\n"," 84%|████████▍ | 545/648 [28:03<09:41,  5.64s/it]\u001b[A\n"," 84%|████████▍ | 546/648 [28:18<14:04,  8.28s/it]\u001b[A\n"," 84%|████████▍ | 547/648 [28:19<10:32,  6.26s/it]\u001b[A\n"," 85%|████████▍ | 548/648 [28:20<07:44,  4.65s/it]\u001b[A\n"," 85%|████████▍ | 550/648 [28:20<05:20,  3.27s/it]\u001b[A\n"," 85%|████████▌ | 552/648 [28:22<04:12,  2.63s/it]\u001b[A\n"," 85%|████████▌ | 554/648 [28:30<04:43,  3.01s/it]\u001b[A\n"," 86%|████████▌ | 555/648 [28:31<03:47,  2.45s/it]\u001b[A\n"," 86%|████████▌ | 556/648 [28:33<03:14,  2.11s/it]\u001b[A\n"," 86%|████████▌ | 557/648 [28:33<02:27,  1.62s/it]\u001b[A\n"," 86%|████████▌ | 558/648 [28:33<01:45,  1.17s/it]\u001b[A\n"," 86%|████████▋ | 559/648 [28:37<02:44,  1.85s/it]\u001b[A\n"," 86%|████████▋ | 560/648 [28:37<01:57,  1.34s/it]\u001b[A\n"," 87%|████████▋ | 561/648 [28:39<02:22,  1.63s/it]\u001b[A\n"," 87%|████████▋ | 562/648 [28:42<02:37,  1.83s/it]\u001b[A\n"," 87%|████████▋ | 563/648 [28:43<02:14,  1.58s/it]\u001b[A\n"," 87%|████████▋ | 564/648 [28:43<01:57,  1.40s/it]\u001b[A\n"," 87%|████████▋ | 565/648 [28:44<01:39,  1.20s/it]\u001b[A\n"," 87%|████████▋ | 566/648 [28:47<02:15,  1.66s/it]\u001b[A\n"," 88%|████████▊ | 567/648 [28:48<01:53,  1.40s/it]\u001b[A\n"," 88%|████████▊ | 568/648 [28:48<01:22,  1.03s/it]\u001b[A\n"," 88%|████████▊ | 569/648 [29:23<14:49, 11.27s/it]\u001b[A\n"," 88%|████████▊ | 570/648 [29:25<11:11,  8.60s/it]\u001b[A\n"," 88%|████████▊ | 571/648 [29:28<08:35,  6.70s/it]\u001b[A\n"," 88%|████████▊ | 572/648 [30:16<24:11, 19.09s/it]\u001b[A\n"," 88%|████████▊ | 573/648 [30:16<16:45, 13.41s/it]\u001b[A\n"," 89%|████████▊ | 574/648 [30:17<12:00,  9.74s/it]\u001b[A\n"," 89%|████████▊ | 575/648 [30:23<10:30,  8.64s/it]\u001b[A\n"," 89%|████████▉ | 576/648 [30:23<07:18,  6.09s/it]\u001b[A\n"," 89%|████████▉ | 577/648 [30:24<05:08,  4.35s/it]\u001b[A\n"," 89%|████████▉ | 578/648 [30:27<04:44,  4.06s/it]\u001b[A\n"," 89%|████████▉ | 579/648 [30:27<03:20,  2.90s/it]\u001b[A\n"," 90%|████████▉ | 580/648 [30:28<02:34,  2.27s/it]\u001b[A\n"," 90%|████████▉ | 581/648 [30:29<02:04,  1.85s/it]\u001b[A\n"," 90%|████████▉ | 583/648 [30:29<01:26,  1.33s/it]\u001b[A\n"," 90%|█████████ | 584/648 [30:29<01:03,  1.00it/s]\u001b[A\n"," 90%|█████████ | 586/648 [30:30<00:52,  1.18it/s]\u001b[A\n"," 91%|█████████ | 587/648 [30:41<03:44,  3.69s/it]\u001b[A\n"," 91%|█████████ | 588/648 [30:41<02:38,  2.64s/it]\u001b[A\n"," 91%|█████████ | 591/648 [30:41<01:47,  1.88s/it]\u001b[A\n"," 91%|█████████▏| 592/648 [30:42<01:30,  1.61s/it]\u001b[A\n"," 92%|█████████▏| 593/648 [30:43<01:17,  1.41s/it]\u001b[A\n"," 92%|█████████▏| 594/648 [30:43<00:58,  1.09s/it]\u001b[A\n"," 92%|█████████▏| 595/648 [30:44<00:58,  1.10s/it]\u001b[A\n"," 92%|█████████▏| 596/648 [30:48<01:29,  1.72s/it]\u001b[A\n"," 92%|█████████▏| 597/648 [30:49<01:24,  1.66s/it]\u001b[A\n"," 92%|█████████▏| 598/648 [31:00<03:39,  4.38s/it]\u001b[A\n"," 92%|█████████▏| 599/648 [31:04<03:24,  4.18s/it]\u001b[A\n"," 93%|█████████▎| 600/648 [31:04<02:32,  3.18s/it]\u001b[A\n"," 93%|█████████▎| 601/648 [31:08<02:40,  3.42s/it]\u001b[A\n"," 93%|█████████▎| 602/648 [31:11<02:19,  3.04s/it]\u001b[A\n"," 93%|█████████▎| 603/648 [31:13<02:08,  2.85s/it]\u001b[A\n"," 93%|█████████▎| 604/648 [31:13<01:33,  2.13s/it]\u001b[A\n"," 93%|█████████▎| 605/648 [31:17<01:54,  2.66s/it]\u001b[A\n"," 94%|█████████▎| 606/648 [31:21<02:02,  2.91s/it]\u001b[A\n"," 94%|█████████▎| 607/648 [31:24<02:07,  3.12s/it]\u001b[A\n"," 94%|█████████▍| 608/648 [31:25<01:30,  2.26s/it]\u001b[A\n"," 94%|█████████▍| 610/648 [31:25<01:01,  1.62s/it]\u001b[A\n"," 94%|█████████▍| 611/648 [31:26<00:52,  1.42s/it]\u001b[A\n"," 94%|█████████▍| 612/648 [31:27<00:45,  1.27s/it]\u001b[A\n"," 95%|█████████▍| 613/648 [31:29<00:54,  1.56s/it]\u001b[A\n"," 95%|█████████▍| 614/648 [31:29<00:40,  1.18s/it]\u001b[A\n"," 95%|█████████▍| 615/648 [31:31<00:39,  1.18s/it]\u001b[A\n"," 95%|█████████▌| 616/648 [31:40<01:54,  3.57s/it]\u001b[A\n"," 95%|█████████▌| 617/648 [31:50<02:49,  5.45s/it]\u001b[A\n"," 95%|█████████▌| 618/648 [31:59<03:20,  6.70s/it]\u001b[A\n"," 96%|█████████▌| 619/648 [32:03<02:47,  5.76s/it]\u001b[A\n"," 96%|█████████▌| 620/648 [32:04<02:00,  4.32s/it]\u001b[A\n"," 96%|█████████▌| 621/648 [32:09<02:06,  4.67s/it]\u001b[A\n"," 96%|█████████▌| 622/648 [32:12<01:45,  4.06s/it]\u001b[A\n"," 96%|█████████▌| 623/648 [32:12<01:14,  2.96s/it]\u001b[A\n"," 96%|█████████▋| 624/648 [32:13<00:52,  2.19s/it]\u001b[A\n"," 96%|█████████▋| 625/648 [32:15<00:54,  2.38s/it]\u001b[A\n"," 97%|█████████▋| 626/648 [32:18<00:55,  2.54s/it]\u001b[A\n"," 97%|█████████▋| 627/648 [32:20<00:45,  2.18s/it]\u001b[A\n"," 97%|█████████▋| 628/648 [32:30<01:34,  4.72s/it]\u001b[A\n"," 97%|█████████▋| 629/648 [32:31<01:07,  3.53s/it]\u001b[A\n"," 97%|█████████▋| 631/648 [32:31<00:42,  2.49s/it]\u001b[A\n"," 98%|█████████▊| 632/648 [32:32<00:29,  1.87s/it]\u001b[A\n"," 98%|█████████▊| 633/648 [32:32<00:21,  1.46s/it]\u001b[A\n"," 98%|█████████▊| 634/648 [32:32<00:15,  1.08s/it]\u001b[A\n"," 98%|█████████▊| 635/648 [32:37<00:26,  2.02s/it]\u001b[A\n"," 98%|█████████▊| 636/648 [32:37<00:17,  1.46s/it]\u001b[A\n"," 98%|█████████▊| 637/648 [32:41<00:24,  2.25s/it]\u001b[A\n"," 99%|█████████▊| 639/648 [32:41<00:14,  1.63s/it]\u001b[A\n"," 99%|█████████▉| 640/648 [32:43<00:13,  1.68s/it]\u001b[A\n"," 99%|█████████▉| 642/648 [32:43<00:07,  1.20s/it]\u001b[A\n"," 99%|█████████▉| 644/648 [32:43<00:03,  1.17it/s]\u001b[A\n","100%|█████████▉| 645/648 [32:44<00:02,  1.30it/s]\u001b[A\n","100%|█████████▉| 646/648 [32:46<00:02,  1.31s/it]\u001b[A\n","100%|█████████▉| 647/648 [32:47<00:01,  1.18s/it]\u001b[A\n","100%|██████████| 648/648 [32:49<00:00,  3.04s/it]\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"mbfYNrddzOPu"},"source":["adv_valid_set.to_csv(output_dir+'/adv_valid_set.csv')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":200},"id":"CrbhtELpj9_n","executionInfo":{"status":"ok","timestamp":1621030938053,"user_tz":240,"elapsed":221,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"3e7b3b29-6b48-46f1-a31c-5f54fb82d5b7"},"source":["valid_set.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>segment</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Sci-News.com does not knowingly collect or sol...</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Sci-News.com does not knowingly collect or sol...</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Submitting an Order When you submit an order ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Submitting an Order When you submit an order ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>We use cookies to enhance the browsing and sho...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                             segment  label\n","0  Sci-News.com does not knowingly collect or sol...      5\n","1  Sci-News.com does not knowingly collect or sol...     11\n","2   Submitting an Order When you submit an order ...      0\n","3   Submitting an Order When you submit an order ...      1\n","4  We use cookies to enhance the browsing and sho...      0"]},"metadata":{"tags":[]},"execution_count":54}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":200},"id":"oJVA0uPwj67M","executionInfo":{"status":"ok","timestamp":1621031000474,"user_tz":240,"elapsed":217,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"81ede060-192c-4f27-93f5-cff11d71fc8d"},"source":["adv_valid_set.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>segment</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Sci-News.com does not knowingly collect or hoo...</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Sci-News.com does not knowingly collect or sol...</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>render an put When you resign an order we ask...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>render an ordination When you submit an dicta...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>We use cookies to enhance the rate and frequen...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                             segment  label\n","0  Sci-News.com does not knowingly collect or hoo...      5\n","1  Sci-News.com does not knowingly collect or sol...     11\n","2   render an put When you resign an order we ask...      0\n","3   render an ordination When you submit an dicta...      1\n","4  We use cookies to enhance the rate and frequen...      0"]},"metadata":{"tags":[]},"execution_count":56}]},{"cell_type":"markdown","metadata":{"id":"nNXJMvAB0FCN"},"source":["--- Now let's evaluate the (non-robust) model adversarial validation data\n"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":396},"id":"PCtB4OqL0FCc","executionInfo":{"status":"ok","timestamp":1621031130114,"user_tz":240,"elapsed":14733,"user":{"displayName":"Ophir Gal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GhUzQDnmZYR6DKi5yEJXmdA_DE9U1uGX09u5ofw=s64","userId":"17199907658380278319"}},"outputId":"9414e961-6b35-4a01-b6f2-174ccfd6de52"},"source":["model = DistilBertForSequenceClassification.from_pretrained(\n","    output_dir, \n","    num_labels=len(idx2label),\n","    id2label=idx2label, # use to show text labels\n",")\n","model.eval()\n","evaluator = Trainer(\n","    model=model,                         # the instantiated 🤗 Transformers model to be trained\n","    eval_dataset=adv_val_dataset,             # evaluation dataset\n",")\n","\n","eval_results = evaluator.predict(adv_val_dataset)\n","model.to('cpu')\n","\n","# produce one-hot preds \n","y_true = eval_results[1].tolist()\n","y_pred = eval_results[0].argmax(axis=-1).tolist()\n","\n","label_names = list(label2idx.keys())\n","# Print and save classification report\n","print('Validation Flat Accuracy: ', accuracy_score(y_true, y_pred),'\\n')\n","\n","clf_report = classification_report(y_true, y_pred, target_names=label_names)\n","pickle.dump(clf_report, open(output_dir+'/classification_report.txt','wb')) #save report\n","print(clf_report)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='81' max='81' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [81/81 00:10]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Validation Flat Accuracy:  0.7253086419753086 \n","\n","                                      precision    recall  f1-score   support\n","\n","          First Party Collection/Use       0.77      0.72      0.74       176\n","      Third Party Sharing/Collection       0.72      0.81      0.76       158\n","      User Access, Edit and Deletion       0.74      0.71      0.72        24\n","                      Data Retention       0.57      0.29      0.38        14\n","                       Data Security       0.63      0.77      0.70        31\n","International and Specific Audiences       0.79      0.90      0.84        41\n","                        Do Not Track       0.75      0.50      0.60         6\n","                       Policy Change       0.80      0.80      0.80        25\n","                 User Choice/Control       0.64      0.67      0.65        48\n","                Introductory/Generic       0.79      0.68      0.73        72\n","                Practice not covered       0.37      0.33      0.35        21\n","         Privacy contact information       0.72      0.72      0.72        32\n","\n","                            accuracy                           0.73       648\n","                           macro avg       0.69      0.66      0.67       648\n","                        weighted avg       0.73      0.73      0.72       648\n","\n"],"name":"stdout"}]}]}